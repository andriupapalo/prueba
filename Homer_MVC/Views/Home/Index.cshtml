
@{
    ViewBag.Title = "Movimientos de Empleados";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Styles {
    @Styles.Render("~/bundles/select2/css")
    <link href="~/Vendor/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="~/Vendor/select2-4.0.3/select2.min.css" rel="stylesheet" />
    <link href="~/Vendor/datatable-1.10.19/dataTable.min.css" rel="stylesheet" />
    <link href="~/Vendor/EasyAutocomplete-1.3.5/easy-autocomplete.min.css" rel="stylesheet" />
    <link href="~/Vendor/EasyAutocomplete-1.3.5/easy-autocomplete.themes.min.css" rel="stylesheet" />
}
<div class="panel-body">
    <div class="panel-heading" style="background-color:white;  border:solid 1px; border-color:#e4e5e7">
        <div class="panel-body">

            <div id="hbreadcrumb" class="pull-right">


            </div>
        </div>
    </div>
</div>


<div class="panel-body" style="padding-top:0px">
    <div class="hpanel">
        <div id="tabs" class="tab-content">
            <ul id="tabs-crear" class="nav nav-tabs">
                <li class="principal active" onclick="buscarAjaxMovimientos();"><a data-toggle="tab" href="#buscar"><i class="fa fa-search"></i>&nbsp;&nbsp;Movimientos empleados</a></li>
                @*Recepción Traslados*@
                            </ul>

            <div id="buscar" class="tab-pane active">
                <div class="panel-body">
                    <div class="panel-body-busqueda">
                        <div class="row">

                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label class="control-label col-md-4">Tiendas:&nbsp;<span class="text-danger"></span></label>
                                    <div class="col-md-8">
                                        @Html.DropDownList("tienda", null, htmlAttributes: new { @class = "form-control js-source-states", @placeholder = "Seleccione", })
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label class="control-label col-md-4">Empleados:&nbsp;<span class="text-danger"></span></label>
                                    <div class="col-md-8">
                                        @Html.DropDownList("empleado", null, "Seleccione", htmlAttributes: new { @class = "form-control js-source-states", @placeholder = "Seleccione", })
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label class="control-label col-md-4">Cargos:&nbsp;<span class="text-danger"></span></label>
                                    <div class="col-md-8">
                                        @Html.DropDownList("cargo", null, "Seleccione", htmlAttributes: new { @class = "form-control js-source-states", @placeholder = "Seleccione", })
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-5">
                                <div class="row">
                                    <div class="col-md-5" style="padding-right: 0">
                                        <input type="text" class="input-sm form-control col-md-4 fechas" name="buscardesde2" id="buscardesde2" value="" placeholder="Fecha Inicio" autocomplete="off" />
                                    </div>
                                    <div class="col-md-2" style="padding-left: 0; padding-right: 0;">
                                        <span class="input-group-addon">Hasta</span>
                                    </div>
                                    <div class="col-md-5" style="padding-left: 0">
                                        <input type="text" class="input-sm form-control col-md-4 fechas" name="buscarhasta2" id="buscarhasta2" value="" placeholder="Fecha Fin" autocomplete="off" />
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4" style="/*padding-top:10px;*/">
                                <div class="input-group">
                                    <input type="text" id="txtFiltroGeneral2" placeholder="Buscar..." class="form-control"> <span class="input-group-btn">
                                        <button type="button" class="btn btn-primary" id="botonbuscar2">
                                            <i class="fa fa-search">&nbsp;Buscar</i>
                                        </button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <div id="div-mensaje-buscar"></div>
                            <table class="table table-striped table-bordered table-hover" id="tablaPaginadast">
                                <thead>
                                    <tr>
                                        <th style="text-align:center">Fecha</th>
                                        <th style="text-align:center">Tienda</th>
                                        <th style="text-align:center">Cedula</th>
                                        <th style="text-align:center">Nombre</th>
                                        <th style="text-align:center">Cargo</th>
                                        <th style="text-align:center">Fecha</th>
                                        <th style="text-align:center">Nro Horas</th>
                                        <th style="text-align:center">Acci&oacute;n</th>

                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>






@section Scripts {
    @*@Scripts.Render("~/bundles/select2/js")*@
    <script src="~/Vendor/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="~/Vendor/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
    <script src="~/Vendor/datatablesExcelExport/dataTable1.4.0-buttons.js"></script>
    <script src="~/Vendor/datatablesExcelExport/JSZip3.1.3.min.js"></script>
    <script src="~/Vendor/datatablesExcelExport/jsZipDataTables.js"></script>
    <script src="~/Vendor/EasyAutocomplete-1.3.5/jquery.easy-autocomplete.min.js"></script>
    <script src="~/Vendor/moment/min/moment.min.js"></script>
    <script src="~/Vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
    <script src="~/Vendor/bootstrap-datepicker-master/dist/js/bootstrap-datepicker.min.js"></script>

    @*Se agregaron estos links para actualizar las librerias*@
    <script type="text/javascript">

    $(document).ready(function () {
        $('.fechas').datetimepicker({
            format: 'YYYY/MM/DD',
            maxDate: `-${new Date()}`
        });
            $('.js-source-states').select2();
        //porGestionar();
        buscarAjaxTraslados();

    });

        $('#botonbuscar').click(function () {
        $('#botonbuscar').prop('disabled', true);
        porGestionar();
        });

        $('#botonbuscar2').click(function () {
        buscarAjaxMovimientos();
        });

    function buscarAjaxMovimientos() {
        var tiend = $('#tienda').val();
        var emple = $('#empleado').val();
        var carg = $('#cargo').val();
        $('#tablaPaginadast').dataTable().fnDestroy();

        $.ajax({
            url: '/Home/BuscarMovimientos',
            data: {
                id_tercero,
                id_tipo_seguimiento,
                temperatura,
                nota
            },
            type: "post",
            cache: false,
            success: function (data) {
                $('#tablaPaginadast').find('tbody').empty();
                for (var i = 0; i < data.length; i++) {
                    $('#tablaPaginadast').find('tbody').append('<tr>'
                        + '<td align="left">' + data[i].fecha + '</td>'
                        + '<td align="left">' + data[i].nomtienda + '</td>'
                        + '<td align="center">' + data[i].Cedula + '</td>'
                        + '<td align="left">' + data[i].nomempleado + '</td>'
                        + '<td align="left">' + data[i].NomCargo + '</td>'
                        + '<td align="left">' + data[i].totalhoras + '</td>'
                        + '</tr>');
                }
            },
            error: function () {
                toastr.error("error server");
            }
        });
    }


    $('#btnGenerar').click(function () {
        var id = $('#btnGenerar').val();

        $.ajax({
            url: '/trasladoRepuestos/agregarEstado',
            data: { id:id
            },
            type: "post",
            cache: false,
            success: function (result) {
                if (result == 1) {
                    console.log(result)
                } else {
                    console.log(result)
                }
            }
        });
    });

    </script>
}
