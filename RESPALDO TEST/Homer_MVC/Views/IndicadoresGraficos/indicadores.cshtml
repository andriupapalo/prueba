@using System.Globalization;
@{
    ViewBag.Title = "Indicadores";
    ViewBag.Icono = "fa fa-bar-chart";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Styles {
    @Styles.Render("~/bundles/select2/css")
}
<!-- App styles -->
<link href="~/Vendor/BootstrapMultiselect/multiselect.css" rel="stylesheet" />
<link href="~/Vendor/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />
<link rel="stylesheet" href="~/vendor/chartist/custom/chartist.css" />
<link href="~/Vendor/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet" />

<div class="panel-body">
    <div class="panel-heading" style="background-color:white;  border:solid 1px; border-color:#e4e5e7">
        <div class="panel-body">

            <div id="hbreadcrumb" class="pull-right">

                <button type="button" class="btn btn-mini btn-default" style="border-radius:25px" data-container="body" data-toggle="popover" data-placement="left" data-title="Enlaces" data-content="<ul>@ViewBag.nombreEnlaces</ul>" data-html="true">
                    <i class="text-info fa fa-tags"></i>
                </button>
                <button type="button" class="btn btn-mini btn-default" style="border-radius:25px" data-container="body" data-toggle="popover" data-placement="left" data-title="Documentos" data-content="<ul></i><a href=''>Documento 1</a></ul>  <ul></i><a href=''>Documento 2</a></ul> <ul></i><a href=''>Documento 3</a></ul>" data-html="true">
                    <i class="text-primary fa fa-files-o"></i>
                </button>
                <button type="button" class="btn btn-mini btn-default" style="border-radius:25px" data-container="body" data-toggle="popover" data-placement="left" data-title="Favoritos" data-content="@ViewBag.Favoritos" data-html="true">
                    <i class="text-warning fa fa-star"></i>
                </button>

            </div>
            <h3 class="font-light m-b-xs">
                <i class="text-info @ViewBag.Icono"></i>&nbsp;&nbsp;@ViewBag.Title
            </h3>
            <small>@ViewBag.Title</small>
        </div>
    </div>
</div>

<div class="panel-body" style="padding-top:0px;">
    <div class="hpanel">

        <div class="alert alert-danger  alert-dismissible" id="divError" style="display:none">
            <button type="button" class="close" data-dismiss="alert" arial-label="close"><span aria-hidden="true">&times;</span></button>
            <p id="mensajeError"><i class="fa fa-times fa-2x"></i></p>
        </div>

        <div id="tabs" class="tab-content">

            <div class="m float-e-margins text-right">
                <div class="tooltip-demo">

                    <div id="div-mensaje"></div>

                </div>
            </div>
            <ul id="tabs-crear" class="nav nav-tabs">
                <li class="active"><a data-toggle="tab" href="#principal"><i class="@ViewBag.Icono"></i>&nbsp;&nbsp;@ViewBag.Title</a></li>
                <li class=""><a data-toggle="tab" href="#metas"><i class="@ViewBag.Icono"></i>&nbsp;&nbsp;Metas VS Productividad</a></li>
                <li class=""><a data-toggle="tab" href="#ranking_matriculas"><i class="@ViewBag.Icono"></i>&nbsp;&nbsp;Ranking De Matrículas</a></li>
            </ul>

            <div id="principal" class="tab-pane active">
                <div class="panel-body">

                    <div class="content">
                        <input type="hidden" class="input-sm form-control" name="nuevo" id="nuevo" />
                        <input type="hidden" class="input-sm form-control" name="usado" id="usado" />

                        <div class="row">
                            <div class="col-md-3">
                                <div>
                                    <label>Bodega(s)</label>
                                    <select id="listar_bodegas" name="listar_bodegas" multiple="multiple" placeholder="Selección múltiple" class="form-control"></select>
                                </div>
                            </div>
                            <div class="col-md-4" id="fechas_consulta">
                                <label>Fechas</label>
                                <div class="input-daterange input-group" id="datepicker">
                                    <input type="text" class="input-sm form-control" name="fechaDesde" id="fechaDesde" value="@ViewBag.fecha_desde" placeholder="Fecha Inicio" required="required" />
                                    <span class="input-group-addon">Hasta</span>
                                    <input type="text" class="input-sm form-control" name="fechaHasta" id="fechaHasta" value="@ViewBag.fecha_hasta" placeholder="Fecha Fin" required="required" />
                                </div>
                            </div>
                            <br />
                            <div class="col-md-2 col-md-offset-2">
                                <button type="button" class="btn btn-primary" id="btnFiltrar"><i class="fa fa-filter" aria-hidden="true"></i>&nbsp;&nbsp;Filtrar</button>
                            </div>
                        </div>
                        <br />
                        <div class="row">

                            <div class="col-md-3">
                                <div id="listar_asesor_div">
                                    <label>Asesor(es)</label>
                                    <select id="listar_asesor" name="listar_asesor" multiple="multiple" placeholder="Selección múltiple" class="form-control"></select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="table-responsive" style="height:50%; padding: 5px; width:100%;">
                                <div id="div_tablas" class="col-md-4" style="height:70px; padding: 5px; width:35%; /*float:right;*/ ">
                                    <table id="tabla_accesorios" style="width:100%" class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th style="text-align: center">&nbsp;Facturados&nbsp;</th>
                                                <th style="text-align: center">&nbsp;Total Accesorios&nbsp;</th>
                                                <th style="text-align: center">&nbsp;Share&nbsp;</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                    <h4>Entradas Por Anfitriona</h4>
                                    <table id="tabla_anfitriona_coordinador" style="display:none; width:100%" class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th style="text-align: center">Vitrina</th>
                                                <th style="text-align: center">Entradas</th>
                                                <th style="text-align: center">Créditos</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                    <table id="tabla_anfitriona_asesor" style="display:none; width:100%" class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th style="text-align: center">Vitrina</th>
                                                <th style="text-align: center">Entradas</th>
                                                <th style="text-align: center">Créditos</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                    <h4>Entradas Por Agendamiento de Citas</h4>
                                    <table id="tabla_agendamiento_citas" style="width:100%" class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th style="text-align: center">Vitrina</th>
                                                <th style="text-align: center">Atendidas</th>
                                                <th style="text-align: center">Canceladas</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                                <div class="col-md-7">
                                    <div id="chartdiv" style="width:100%;height:400px; margin:0; padding:0; /*float:left*/"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="metas" class="tab-pane">
                <div class="panel-body">
                    <div class="content">
                        <input type="hidden" class="input-sm form-control" name="nuevo" id="nuevo" />
                        <input type="hidden" class="input-sm form-control" name="usado" id="usado" />

                        <div id="errorCampos" class="alert alert-danger" style="display:none">
                            <strong>Error!</strong>Todos los campos son obligatorios, por favor valide.
                        </div>

                        <div class="row">
                            <div class="col-md-3">
                                <div>
                                    <label>Bodega(s)</label>
                                    <select class="form-control js-source-states" id="selectBodegas" name="selectBodegas" required="required"></select>
                                </div>
                            </div>
                            <div class="col-md-4" id="fechas_consulta">
                                <label>Fechas</label>
                                <div class="input-daterange input-group" id="datepicker">
                                    <input type="text" class="input-sm form-control" name="fechaDesdeMetas" id="fechaDesdeMetas" value="@ViewBag.fecha_desde" placeholder="Fecha Inicio" required="required" />
                                    <span class="input-group-addon">Hasta</span>
                                    <input type="text" class="input-sm form-control" name="fechaHastaMetas" id="fechaHastaMetas" value="@ViewBag.fecha_hasta" placeholder="Fecha Fin" required="required" />
                                </div>
                            </div>
                            <br />
                            <div class="col-md-3 col-md-offset-2">
                                <button type="button" class="btn btn-primary" id="btnFiltrarMetas"><i class="fa fa-filter" aria-hidden="true"></i>&nbsp;&nbsp;Metas</button>
                                <button type="button" class="btn btn-success" id="btnPronostico"><i class="fa fa-filter" aria-hidden="true"></i>&nbsp;&nbsp;Pronóstico Mensual</button>
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-3">
                                <div id="asesores">
                                    <label>Asesor(es)</label>
                                    <select class="form-control js-source-states" id="selectAsesor" name="selectASesor" required="required"></select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="table-responsive">
                            <div class="col-md-6">
                                <div id="metasVSproductividad"><h2><strong>METAS VS PRODUCTIVIDAD</strong></h2></div>
                                <div id="chartdivMetas" style="width:100%;height:400px; margin:0; padding:0;"></div>
                            </div>
                            <div class="col-md-6">
                                <div class="row">
                                    <div id="pronosticoAsesor"></div>
                                    <div id="asesorProductivo"></div>
                                </div>
                                <div id="chartdivProductivo" style="width:100%;height:400px; margin:0; padding:0; "></div>
                                <div id="chartdivPronostico" style="width:100%;height:400px; margin:0; padding:0; "></div>
                            </div>
                        </div>
                    </div>
                    <div id="row">
                        <div class="col-md-6">
                            <h3>
                                <label id="share"></label>
                            </h3>
                        </div>
                        <div id="tabla_accesorios2" class="col-md-4" style="height:70px; width:50%; padding: 5px; float:right ">
                            <table id="tabla_accesorios" style="width:100%" class="table table-striped table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th style="text-align: center">&nbsp;Facturados&nbsp;</th>
                                        <th style="text-align: center">&nbsp;Total Accesorios&nbsp;</th>
                                        <th style="text-align: center">&nbsp;Share&nbsp;</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="ranking_matriculas" class="tab-pane">
                <div class="panel-body">
                    <div class="alert alert-danger  alert-dismissible" id="divErrorMatriculas" style="display:none">
                        <button type="button" class="close" data-dismiss="alert" arial-label="close"><span aria-hidden="true">&times;</span></button>
                        <p id="mensajeErrorMatriculas"><i class="fa fa-times fa-2x"></i></p>
                    </div>
                    <div class="row">
                        <div class="col-md-5"></div>
                        <div class="col-md-7" id="botonesMatriculas">
                            <button type="button" class="btn btn-success" id="botonVerRanking">Ver Ranking</button>
                            <button type="button" class="btn btn-info" id="botonGraficaAnual">Ver Gráfica Anual</button>
                        </div>
                    </div>
                    <div class="content">
                        <div id="tabla_ranking" style="display:none">
                            <div class="row">
                                <div class="col-md-3">
                                    <div>
                                        <label>Bodega(s)</label>
                                        <select id="bodegasRanking" name="bodegasRanking" multiple="multiple" placeholder="Selección múltiple" class="form-control"></select>
                                    </div>
                                </div>
                                <div class="col-md-4" id="fechas_consulta">
                                    <label>Fechas</label>
                                    <div class="input-daterange input-group" id="datepicker">
                                        <input type="text" class="input-sm form-control" name="fechaDesdeRanking" id="fechaDesdeRanking" value="@ViewBag.fecha_desde" placeholder="Fecha Inicio" required="required" />
                                        <span class="input-group-addon">Hasta</span>
                                        <input type="text" class="input-sm form-control" name="fechaHastaRanking" id="fechaHastaRanking" value="@ViewBag.fecha_hasta" placeholder="Fecha Fin" required="required" />
                                    </div>
                                </div>
                                <br />
                                <div class="col-md-2 col-md-offset-2">
                                    <button type="button" class="btn btn-primary" id="btnFiltrarRanking"><i class="fa fa-filter" aria-hidden="true"></i>&nbsp;&nbsp;Filtrar</button>
                                </div>
                            </div>
                            <div id="tabla_ranking" class="col-md-4" style="padding: 5px; width:35%;">
                                <table id="tabla_ranking" style="width:100%" class="table table-striped table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            <th style="text-align: center">&nbsp;Ranking&nbsp;</th>
                                            <th style="text-align: center">&nbsp;Asesor&nbsp;</th>
                                            <th style="text-align: center">&nbsp;N° Matrículas&nbsp;</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                        <div id="chart_line" style="display:none">
                            <div class="col-md-2">
                                <select id="anio_matriculas" class="form-control">
                                    <option value="2018">2018</option>
                                    <option value="2019">2019</option>
                                    <option value="2020">2020</option>
                                </select>
                            </div>
                            <button type="button" class="btn btn-primary" id="boton_filtrar_matriculas"><i class="fa fa-filter"></i>&nbsp;Filtrar</button>
                            <div style="width:100%; display:none" id="grafico_lineal">
                                <canvas id="canvas"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*============= modal solicitados ===================*@
<div class="modal fade hmodal-info" id="modal_creditos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Creditos Solicitados</h4>
                <small class="font-bold">Detalle de creditos solicitados</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <div id="div-mensaje-buscar">
                        <span class="font-bold">Estados Creditos:</span>&nbsp;&nbsp;
                        <label class="label label-warning">T</label>&nbsp;Tramite&nbsp;&nbsp;
                        <label class="label label-success">A</label>&nbsp;Aprobado&nbsp;&nbsp;
                        <label class="label label-danger">N</label>&nbsp;Negado&nbsp;&nbsp;
                        <label class="label label-primary">C</label>&nbsp;Confirmado&nbsp;&nbsp;
                        <label class="label label-info">D</label>&nbsp;Desembolsado&nbsp;&nbsp;
                        <label class="label label-default">O</label>&nbsp;Desistio&nbsp;&nbsp;
                    </div><br />
                    <table class="table table-striped table-bordered table-hover" id="tabla_solicitados">
                        <thead>
                            <tr>
                                <th style="text-align:center">Pedido #</th>
                                <th style="text-align:center">Fecha Solicitud</th>
                                <th style="text-align:center">Valor Solicitado</th>
                                <th style="text-align:center">Estado Credito</th>
                                <th style="text-align:center">Plazo</th>
                                <th style="text-align:center">Financiera</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Teléfono</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Bodega</th>
                                <th style="text-align:center">Tipo</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal cotizaciones ===================*@
<div class="modal fade hmodal-warning" id="modal_cotizaciones" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Cotizaciones</h4>
                <small class="font-bold">Detalle de cotizaciones</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_cotizaciones">
                        <thead>
                            <tr>
                                <th style="text-align:center">Cotizacion #</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Teléfono</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Origen</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Bodega</th>
                                <th style="text-align:center">Tipo</th>

                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                @*<button type="button" class="btn btn-primary" data-dismiss="modal">Aceptar</button>*@
            </div>
        </div>
    </div>
</div>

@*============= modal prospectos ===================*@
<div class="modal fade hmodal-primary" id="modal_prospectos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Prospectos</h4>
                <small class="font-bold">Detalle de prospectos por fuente</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_prospectos">
                        <thead>
                            <tr>
                                <th style="text-align:center">Origen</th>
                                <th style="text-align:center">Cantidad</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal pedidos ===================*@
<div class="modal fade hmodal-success" id="modal_pedidos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Pedidos</h4>
                <small class="font-bold">Detalle de pedidos</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_pedidos">
                        <thead>
                            <tr>
                                <th style="text-align:center">Pedido #</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Modelo</th>
                                <th style="text-align:center">Año Modelo</th>
                                <th style="text-align:center">Color</th>
                                <th style="text-align:center">Placa</th>
                                <th style="text-align:center">Plan Venta</th>
                                <th style="text-align:center">Plan Mayor</th>
                                <th style="text-align:center">Fecha Asignacion</th>
                                <th style="text-align:center">Valor Total</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Teléfono</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Bodega</th>
                                <th style="text-align:center">Tipo</th>

                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal aprobados ===================*@
<div class="modal fade hmodal-success" id="modal_aprobados" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Aprobados</h4>
                <small class="font-bold">Detalle De Aprobados</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_aprobados">
                        <thead>
                            <tr>
                                <th style="text-align:center">Pedido #</th>
                                <th style="text-align:center">Fecha Aprobación</th>
                                <th style="text-align:center">Valor Solicitado</th>
                                <th style="text-align:center">Vehículo</th>
                                <th style="text-align:center">Plazo</th>
                                <th style="text-align:center">Financiera</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Teléfono</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Bodega</th>
                                <th style="text-align:center">Tipo</th>

                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal demos ===================*@
<div class="modal fade hmodal-success" id="modal_demos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Demos</h4>
                <small class="font-bold">Detalle De Demos</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_demos">
                        <thead>
                            <tr>
                                <th style="text-align:center">Demo</th>
                                <th style="text-align:center">Descripción</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Documento</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Teléfono</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Bodega</th>
                                <th style="text-align:center">Tipo</th>

                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal facturas ===================*@
<div class="modal fade hmodal-info" id="modal_facturas" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Facturas</h4>
                <small class="font-bold">Detalle de facturas</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_facturas">
                        <thead>
                            <tr>
                                <th style="text-align:center">Factura #</th>
                                <th style="text-align:center">Tipo Factura</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Teléfono</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Financiera</th>
                                <th style="text-align:center">Forma Pago</th>
                                <th style="text-align:center">Fecha Vencimiento</th>
                                <th style="text-align:center">Valor Total</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Bodega</th>
                                <th style="text-align:center">Tipo</th>

                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal matriculas ===================*@
<div class="modal fade hmodal-info" id="modal_matriculas" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Matriculas</h4>
                <small class="font-bold">Detalle de matriculas</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_matriculas">
                        <thead>
                            <tr>
                                <th style="text-align:center">Fecha Matricula</th>
                                <th style="text-align:center">Plan Mayor</th>
                                <th style="text-align:center">Modelo</th>
                                <th style="text-align:center">Año</th>
                                <th style="text-align:center">Color</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Bodega</th>
                                <th style="text-align:center">Tipo</th>

                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal detalle prospectos ===================*@
<div class="modal fade hmodal-primary" id="modal_det_prospectos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Prospectos</h4>
                <small class="font-bold">Detalle de prospectos por fuente</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_det_prospectos">
                        <thead>
                            <tr>
                                <th style="text-align:center">Documento</th>
                                <th style="text-align:center">DV</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Telefono</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Direccion</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Bodega</th>
                                <th style="text-align:center">Tramite</th>
                                <th style="text-align:center">Fuente</th>

                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- Vendor scripts -->
@section Scripts {
    @Scripts.Render("~/bundles/select2/js")
    <script src="~/Vendor/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="~/Vendor/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
    <script src="~/Vendor/datatablesExcelExport/dataTable1.4.0-buttons.js"></script>
    <script src="~/Vendor/datatablesExcelExport/JSZip3.1.3.min.js"></script>
    <script src="~/Vendor/pdfmake/build/pdfmake.min.js"></script>
    <script src="~/Vendor/pdfmake/build/vfs_fonts.js"></script>
    <script src="~/Vendor/datatablesExcelExport/jsZipDataTables.js"></script>
    <script src="~/vendor/d3/d3.min.js"></script>
    <script src="~/vendor/c3/c3.min.js"></script>
    <!-- App scripts -->
    <script src="~/Scripts/homer.js"></script>
    <script src="~/Vendor/moment/min/moment.min.js"></script>
    <script src="~/Vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
    <script src="~/Vendor/BootstrapMultiselect/multiselect.js"></script>
    <script src="~/Vendor/AmCharts/lib/3/amcharts.js"></script>
    <script src="~/Vendor/AmCharts/lib/3/funnel.js"></script>
    <script src="~/Vendor/AmCharts/lib/3/themes/light.js"></script>
    <script src="~/Vendor/chartjs/Chart.min.js"></script>
    <script src="~/Vendor/chartjs/samples/utils.js"></script>
    <link href="~/Vendor/AmCharts/lib/3/plugins/export/export.css" rel="stylesheet" />
    <script src="~/Vendor/AmCharts/lib/3/plugins/export/export.min.js"></script>


    <script>
        var f = new Date();
        var anho = f.getFullYear();
        var mes = (f.getMonth() + 1);
        var fecha = anho + "-" + mes + "-" +  "01";
        var ctx = "";
        $(document).ready(function () {

            $('#nuevo').val(false)
            $('#usado').val(false)

            $('.js-source-states').select2();

            var f = new Date();
            var anho = f.getFullYear();
            var mes = (f.getMonth() + 1);
            var fecha = anho + "-" + mes + "-" +  "01";
            var fecha2 = '@DateTime.Now.ToString("yyyy/MM/dd",new CultureInfo("en-US"))';
            var color = '#';
            $('#fechaDesde').val(fecha);
            $('#fechaHasta').val(fecha2);
            $('#fechaDesde').datetimepicker({
                format: 'YYYY/MM/DD',
                maxDate: '-' + new Date() + '',
            });

            $('#fechaHasta').datetimepicker({
                format: 'YYYY/MM/DD',
                maxDate: '-' + new Date() + '',
            });

            $('#fechaDesdeMetas').val(fecha);
            $('#fechaHastaMetas').val(fecha2);
            $('#fechaDesdeMetas').datetimepicker({
                format: 'YYYY/MM/DD',
                maxDate: '-' + new Date() + '',
            });

            $('#fechaHastaMetas').datetimepicker({
                format: 'YYYY/MM/DD',
                maxDate: '-' + new Date() + '',
            });

            $('#fechaDesdeRanking').val(fecha);
            $('#fechaHastaRanking').val(fecha2);
            $('#fechaDesdeRanking').datetimepicker({
                format: 'YYYY/MM/DD',
                maxDate: '-' + new Date() + '',
            });

            $('#fechaHastaRanking').datetimepicker({
                format: 'YYYY/MM/DD',
                maxDate: '-' + new Date() + '',
            });

            $('#listar_asesor_div').hide();
            $('#metasVSproductividad').hide();
            $('#pronosticoAsesor').hide();
            $('#chartdiv').show();
            $('#chartdivProductivo').show();
            $('#asesorProductivo').hide();
            $('#div_tablas').hide();
            buscarBodegas();
            PermisoVerIndicador();
            buscarbodegasMetas();
            buscarBodegasRanking();
        });
        $('#fechaDesdeMetas').blur(function () {
            var fechaSelect = $('#fechaDesdeMetas').val();
            var separar = fechaSelect.split('/');
            if (separar[2] < anho) {
                $('#btnPronostico').hide();
            }
            if (separar[1] < mes) {
                $('#btnPronostico').hide();
            }
            if (separar[2] == anho && separar[1] == mes) {
                $('#btnPronostico').show();
            }
        });

        $('#listar_bodegas').change(function () {
            buscarAsesor();
        });

        $('#btnFiltrar').click(function () {
            buscarDatos();
            detalleAccesorios();
            buscarEntradasAnfitriona();
            $('#div_tablas').show();
        });

        $('#btnFiltrarRanking').click(function () {
            tablaRanking();
        });

        $('#selectBodegas').change(function () {
            buscarAsesorMetas();
        });

        $('#btnFiltrarMetas').click(function () {
            if ($('#selectBodegas').val() == '' || $('#selectBodegas').val() == null ||
                $('#selectAsesor').val() == '' || $('#selectAsesor').val() == null ||
                $('#fechaDesdeMetas').val() == '' || $('#fechaDesdeMetas').val() == null ||
                $('#fechaHastaMetas').val() == '' || $('#fechaHastaMetas').val() == null) {
                $('#errorCampos').show();
                setTimeout(function () {
                    $("#errorCampos").fadeOut(1500);
                }, 3000);

            } else {
                buscarMetas();
                buscarMetasFijas();
                detalleAccesoriosMetas();
                Share();

                var text_asesor = $("#selectAsesor option:selected").text();
                var mayus = text_asesor.toUpperCase();
                $('#asesorProductivo').html('<h2>' + '<strong>' + mayus + '</strong>' + '</h2>');
                $('#asesorProductivo').show();
                $('#metasVSproductividad').show();
                $('#chartdivMetas').show();
                $('#chartdivProductivo').show();
                $('#pronosticoAsesor').hide(),
                $('#chartdivPronostico').hide();
            }

        })
        $('#btnPronostico').click(function () {
            if ($('#selectBodegas').val() == '' || $('#selectBodegas').val() == null ||
                $('#selectAsesor').val() == '' || $('#selectAsesor').val() == null ||
                $('#fechaDesdeMetas').val() == '' || $('#fechaDesdeMetas').val() == null ||
                $('#fechaHastaMetas').val() == '' || $('#fechaHastaMetas').val() == null) {
                $('#errorCampos').show();
                setTimeout(function () {
                    $("#errorCampos").fadeOut(1500);
                }, 3000);

            } else {
                buscarPronostico();
                detalleAccesoriosMetas();
                Share();
                var text_asesor = $("#selectAsesor option:selected").text();
                var mayus = text_asesor.toUpperCase();
                $('#asesorProductivo').html('<h2><strong>' + mayus + '</strong></h2>');
                $('#pronosticoAsesor').html('<h3><strong>PRONÓSTICO ' + mayus + '</strong></h3>');
                $('#asesorProductivo').hide();
                $('#chartdivProductivo').hide();
                $('#pronosticoAsesor').show();
                $('#chartdivPronostico').show();
                $('#metasVSproductividad').show();
                buscarMetasFijas();
            }
        })
        $('#botonVerRanking').click(function () {
            $('#tabla_ranking').show();
            $('#chart_line').hide();
            $('#grafico_lineal').hide();
            tablaRanking();
        });

        $('#botonGraficaAnual').click(function () {
            $('#tabla_ranking').hide();
            $('#chart_line').show();
        });

        $('#boton_filtrar_matriculas').click(function () {
            var anio_matrilculas = $('#anio_matriculas').val();
            grafico(anio_matrilculas);
            $('#grafico_lineal').show();
        });
        
        function buscarBodegas() {
            $.ajax({
                url: '/IndicadoresGraficos/BuscarBodegas',
                data: {
                    param: $('#listar_bodegas').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    $('#listar_bodegas').empty();
                    $('#listar_bodegas').multiselect("destroy").multiselect({
                        includeSelectAllOption: true,
                        maxHeight: 800,
                    });
                    for (var i = 0; i < data.length; i++) {
                        $('#listar_bodegas').append($('<option>', {
                            value: data[i].id,
                            text: data[i].bodccs_nombre
                        }));
                    }
                    $('#listar_bodegas').multiselect("destroy").multiselect({
                        includeSelectAllOption: true,
                        maxHeight: 800,
                    });
                    $('#listar_bodegas').multiselect('refresh');
                }
            });
        } //ok

        function buscarBodegasRanking() {
            $.ajax({
                url: '/IndicadoresGraficos/BuscarBodegasRanking',
                data: {
                },
                type: "post",
                cache: false,
                success: function (data) {
                    $('#bodegasRanking').empty();

                    for (var i = 0; i < data.length; i++) {
                        $('#bodegasRanking').append($('<option>', {
                            value: data[i].id_bodega,
                            text: data[i].bodccs_nombre
                        }));
                    }

                    $('#bodegasRanking').multiselect("destroy").multiselect({
                        includeSelectAllOption: true,
                        maxHeight: 800,
                    });
                    $('#bodegasRanking').multiselect('refresh');
                }
            });
        } //ok
        //param: $('#listar_bodegas').val(), trabaja con listar
        function buscarAsesor() {
            $.ajax({
                url: '/IndicadoresGraficos/listarAsesorPorBodega',
                data: {
                    param: $('#listar_bodegas').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    $('#listar_asesor').empty();
                    $('#listar_asesor_div').show();

                    for (var i = 0; i < data.length; i++) {
                        $('#listar_asesor').append($('<option>', {
                            value: data[i].user_id,
                            text: data[i].nombre
                        }));
                    }
                    $('#listar_asesor').multiselect("destroy").multiselect({
                        includeSelectAllOption: true,
                        maxHeight: 800,
                    });
                    $('#listar_asesor').multiselect('refresh');
                }
            });
        } //ok

        function buscarDatos() {

            if ($.fn.dataTable.isDataTable('#tabla_solicitados')) {
                $("#tabla_solicitados").dataTable().fnDestroy();
            }

            //if ($.fn.dataTable.isDataTable('#tabla_aprobados')) {
            //    $("#tabla_aprobados").dataTable().fnDestroy();
            //}

            if ($.fn.dataTable.isDataTable('#tabla_prospectos')) {
                $("#tabla_prospectos").dataTable().fnDestroy();
            }

            if ($.fn.dataTable.isDataTable('#tabla_cotizaciones')) {
                $("#tabla_cotizaciones").dataTable().fnDestroy();
            }

            if ($.fn.dataTable.isDataTable('#tabla_demos')) {
                $("#tabla_demos").dataTable().fnDestroy();
            }

            if ($.fn.dataTable.isDataTable('#tabla_pedidos')) {
                $("#tabla_pedidos").dataTable().fnDestroy();
            }

            if ($.fn.dataTable.isDataTable('#tabla_facturas')) {
                $("#tabla_facturas").dataTable().fnDestroy();
            }

            if ($.fn.dataTable.isDataTable('#tabla_matriculas')) {
                $("#tabla_matriculas").dataTable().fnDestroy();
            }

            $.ajax({
                url: '/IndicadoresGraficos/buscarDatos',
                data: {
                    fechaDesde: $('#fechaDesde').val(),
                    fechaHasta: $('#fechaHasta').val(),
                    asesor: $('#listar_asesor').val(),
                    bodega: $('#listar_bodegas').val(), 
                    nuevo: $('#nuevo').val(),
                    usado: $('#usado').val()
                },
                type: "post",
                cache: false,
                success: function (data) {
                    if (data.info == true) {
                        $('#chartdiv').show();

                        var chart = AmCharts.makeChart("chartdiv", {
                            "type": "funnel",
                            "theme": "light",
                            "dataProvider":
                                [{
                                    "title": "Prospectos",
                                    "value": data.data.prospectosListados
                                }, {
                                    "title": "Cotizaciones",
                                    "value": data.data.cotizaciones.length,
                                    "description": "\n" + "Grupo 1: Cotizaciones" + "\n" + "Cantidad: " + data.data.cotizaciones.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.cotizaciones.length / data.data.cotizaciones.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.cotizaciones.length / data.data.cotizaciones.length) * 100) + "%"
                                }, {
                                    "title": "Créditos Solicitados",
                                    "value": data.data.solicitados.length,
                                    "description": "\n" + "Grupo 2: Solicitados" + "\n" + "Cantidad: " + data.data.solicitados.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.solicitados.length / data.data.cotizaciones.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.solicitados.length / data.data.cotizaciones.length) * 100) + "%"
                                }, {
                                    "title": "Créditos Aprobados",
                                    "value": data.data.aprobados.length,
                                    "description": "\n" + "Grupo 3: Aprobados" + "\n" + "Cantidad: " + data.data.aprobados.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.aprobados.length / data.data.cotizaciones.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.aprobados.length / data.data.solicitados.length) * 100) + "%"
                                }, {
                                    "title": "Demos",
                                    "value": data.data.demos.length,
                                    "description": "\n" + "Grupo 4: Demos" + "\n" + "Cantidad: " + data.data.demos.length +
                                        "\n" + "Porcentaje con el primero: " + +parseInt((data.data.demos.length / data.data.cotizaciones.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.demos.length / data.data.aprobados.length) * 100) + "%"
                                }, {
                                    "title": "Pedidos",
                                    "value": data.data.pedidos.length,
                                    "description": "\n" + "Grupo 5: Pedidos" + "\n" + "Cantidad: " + data.data.pedidos.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.pedidos.length / data.data.cotizaciones.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.pedidos.length / data.data.demos.length) * 100) + "%"
                                }, {
                                    "title": "Facturas",
                                    "value": data.data.facturas.length,
                                    "description": "\n" + "Grupo 6: Facturas" + "\n" + "Cantidad: " + data.data.facturas.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.facturas.length / data.data.cotizaciones.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.facturas.length / data.data.pedidos.length) * 100) + "%"
                                }, {
                                    "title": "Matrículas",
                                    "value": data.data.matriculas.length,
                                    "description": "\n" + "Grupo 7: Matrículas" + "\n" + "Cantidad: " + data.data.matriculas.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.matriculas.length / data.data.cotizaciones.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.matriculas.length / data.data.facturas.length) * 100) + "%"

                                }],

                            "valueField": "value",
                            "titleField": "title",
                            "descriptionField": "description",
                            "marginRight": 240,
                            "marginLeft": 50,
                            "startX": -500,
                            "depth3D": 100,
                            "angle": 10,
                            "outlineColor": "#ffffff",
                            "outlineThickness": 2,
                            "labelPosition": "right",
                            "balloonText": "[[description]]",
                            "balloon": {
                                "fixedPosition": true,
                                "textAlign": "left",
                                "maxWidth": "auto"
                            },
                            "AmSlicedChart": {
                                "accessible": false
                            }
                        });

                        chart.addListener("clickSlice", function (event, index) {
                            var posicion = event.dataItem.index;
                            if (posicion == 0) {
                                $('#modal_prospectos').modal('show');
                            } else if (posicion == 1) {
                                $('#modal_cotizaciones').modal('show');
                            } else if (posicion == 2) {
                                $('#modal_creditos').modal('show');
                            } else if (posicion == 3) {
                                $('#modal_aprobados').modal('show');
                            } else if (posicion == 4) {
                                $('#modal_demos').modal('show');
                            } else if (posicion == 5) {
                                $('#modal_pedidos').modal('show');
                            } else if (posicion == 6) {
                                $('#modal_facturas').modal('show');
                            } else if (posicion == 7) {
                                $('#modal_matriculas').modal('show');
                            }
                        });

                        var funnelData = {

                            modals: [
                                "modal_prospectos",
                                "modal_cotizaciones",
                                "modal_aprobados",
                                "modal_demos",
                                "modal_creditos",
                                "modal_pedidos",
                                "modal_facturas",
                                "modal_matriculas"
                            ],
                        };

                        $('#tabla_solicitados').find('tbody').empty();
                        for (var i = 0; i < data.data.solicitados.length; i++) {
                            $('#tabla_solicitados').find('tbody').append('<tr style="text-align:center"><td>'
                                + data.data.solicitados[i].pedido + '</td><td>'
                                + data.data.solicitados[i].fecha + '</td><td>$'
                                + addComas(data.data.solicitados[i].valor_solicitado) + '</td><td>'
                                + data.data.solicitados[i].estado + '</td><td>'
                                + data.data.solicitados[i].plazo + '</td><td>'
                                + data.data.solicitados[i].financiera + '</td><td>'
                                + data.data.solicitados[i].cliente + '</td><td>'
                                + data.data.solicitados[i].telefono + '</td><td>'
                                + data.data.solicitados[i].celular + '</td><td>'
                                + data.data.solicitados[i].correo + '</td><td>'
                                + data.data.solicitados[i].asesor + '</td><td>'
                                + data.data.solicitados[i].bodega + '</td><td>'
                                + data.data.solicitados[i].tipo + '</td></tr>'
                            );
                        }

                        $('#tabla_aprobados').find('tbody').empty();
                        for (var i = 0; i < data.data.aprobados.length; i++) {
                            $('#tabla_aprobados').find('tbody').append('<tr style="text-align:center"><td>'
                                + data.data.aprobados[i].numero + '</td><td>'
                                + data.data.aprobados[i].fecha + '</td><td>'
                                + addComas(data.data.aprobados[i].vsolicitado) + '</td><td>'
                                + data.data.aprobados[i].modvh_nombre + '</td><td>'
                                + data.data.aprobados[i].plazo + '</td><td>'
                                + data.data.aprobados[i].financiera_nombre + '</td><td>'
                                + data.data.aprobados[i].cliente + '</td><td>'
                                + data.data.aprobados[i].telefono + '</td><td>'
                                + data.data.aprobados[i].celular + '</td><td>'
                                + data.data.aprobados[i].correo + '</td><td>'
                                + data.data.aprobados[i].asesor + '</td><td>'
                                + data.data.aprobados[i].bodega + '</td><td>'
                                + data.data.aprobados[i].tipo + '</td><tr>');
                        }

                        $('#tabla_cotizaciones').find('tbody').empty();
                        for (var i = 0; i < data.data.cotizaciones.length; i++) {
                            $('#tabla_cotizaciones').find('tbody').append('<tr style="text-align:center"><td>'
                                + data.data.cotizaciones[i].cot_numcotizacion + '</td><td>'
                                + data.data.cotizaciones[i].fecha + '</td><td>'
                                + data.data.cotizaciones[i].cliente + '</td><td>'
                                + data.data.cotizaciones[i].telefono + '</td><td>'
                                + data.data.cotizaciones[i].celular + '</td><td>'
                                + data.data.cotizaciones[i].correo + '</td><td>'
                                + data.data.cotizaciones[i].tporigen_nombre + '</td><td>'
                                + data.data.cotizaciones[i].asesor + '</td><td>'
                                + data.data.cotizaciones[i].bodega + '</td><td>'
                                + data.data.cotizaciones[i].tipo + '</td></tr>');
                        }

                        $('#tabla_demos').find('tbody').empty();
                        for (var i = 0; i < data.data.demos.length; i++) {
                            $('#tabla_demos').find('tbody').append('<tr style="text-align:center"><td>'
                                + data.data.demos[i].ref_codigo + '</td><td>'
                                + data.data.demos[i].ref_descripcion + '</td><td>'
                                + data.data.demos[i].fecha + '</td><td>'
                                + data.data.demos[i].ncliente + '</td><td>'
                                + data.data.demos[i].nombre + '</td><td>'
                                + data.data.demos[i].telefono + '</td><td>'
                                + data.data.demos[i].celular + '</td><td>'
                                + data.data.demos[i].correo + '</td><td>'
                                + data.data.demos[i].asesor + '</td><td>'
                                + data.data.demos[i].bodega + '</td><td>'
                                + data.data.demos[i].tipo + '</td></tr>');
                        }

                        $('#tabla_prospectos').find('tbody').empty();
                        for (var i = 0; i < data.data.OrigenProspectos.length; i++) {
                            $('#tabla_prospectos').find('tbody').append('<tr style="text-align:center"><td>'
                                + data.data.OrigenProspectos[i].nombre + '</td><td><button type="button" onclick="ver_det_prospectos(' + data.data.OrigenProspectos[i].idorigen + ')" class="btn btn-info btn-xs" >'
                                + data.data.OrigenProspectos[i].cantidad + '</button></td></tr>');
                        }

                        $('#tabla_pedidos').find('tbody').empty();
                        for (var i = 0; i < data.data.pedidos.length; i++) {
                            $('#tabla_pedidos').find('tbody').append('<tr style="text-align:center"><td>'
                                + data.data.pedidos[i].numero + '</td><td>'
                                + data.data.pedidos[i].fecha + '</td><td>'
                                + data.data.pedidos[i].modvh_nombre + '</td><td>'
                                + data.data.pedidos[i].id_anio_modelo + '</td><td>'
                                + data.data.pedidos[i].colvh_nombre + '</td><td>'
                                + data.data.pedidos[i].placa + '</td><td>'
                                + data.data.pedidos[i].plan_venta + '</td><td>'
                                + data.data.pedidos[i].plan_mayor + '</td><td>'
                                + data.data.pedidos[i].fecha_asignacion + '</td><td>$'
                                + addComas(data.data.pedidos[i].vrtotal) + '</td><td>'
                                + data.data.pedidos[i].cliente + '</td><td>'
                                + data.data.pedidos[i].telefono + '</td><td>'
                                + data.data.pedidos[i].celular + '</td><td>'
                                + data.data.pedidos[i].correo + '</td><td>'
                                + data.data.pedidos[i].asesor + '</td><td>'
                                + data.data.pedidos[i].bodega + '</td><td>'
                                + data.data.pedidos[i].tipo + '</td></tr>'
                            );
                        }

                        $('#tabla_facturas').find('tbody').empty();
                        for (var i = 0; i < data.data.facturas.length; i++) {
                            $('#tabla_facturas').find('tbody').append('<tr style="text-align:center"><td>'
                                + data.data.facturas[i].numero + '</td><td>'
                                + data.data.facturas[i].tipo_factura + '</td><td>'
                                + data.data.facturas[i].fecha + '</td><td>'
                                + data.data.facturas[i].nombre + '</td><td>'
                                + data.data.facturas[i].telefono + '</td><td>'
                                + data.data.facturas[i].celular + '</td><td>'
                                + data.data.facturas[i].correo + '</td><td>'
                                + data.data.facturas[i].financiera + '</td><td>'
                                + data.data.facturas[i].fpago_nombre + '</td><td>'
                                + data.data.facturas[i].fecha_vencimiento + '</td><td>$'
                                + addComas(data.data.facturas[i].valor_total) + '</td><td>'
                                + data.data.facturas[i].asesor + '</td><td>'
                                + data.data.facturas[i].bodega + '</td><td>'
                                + data.data.facturas[i].tipo + '</td></tr>');
                        }

                        $('#tabla_matriculas').find('tbody').empty();
                        for (var i = 0; i < data.data.matriculas.length; i++) {
                            $('#tabla_matriculas').find('tbody').append('<tr style="text-align:center"><td>'
                                + data.data.matriculas[i].fecha + '</td><td>'
                                + data.data.matriculas[i].planmayor + '</td><td>'
                                + data.data.matriculas[i].nombre + '</td><td>'
                                + data.data.matriculas[i].anio + '</td><td>'
                                + data.data.matriculas[i].color + '</td><td>'
                                + data.data.matriculas[i].Asesor + '</td><td>'
                                + data.data.matriculas[i].bodega + '</td><td>'
                                + data.data.matriculas[i].tipo + '</td></tr>'
                            );
                        }

                    } else {
                        $('#chartdiv').hide();
                        $('#mensajeError').text(data.mensaje);
                        $('#divError').show();

                        setTimeout(function () {
                            $("#divError").fadeOut(3000);
                        }, 4500);
                    }
                },

                complete: function (data) {

                    $('#tabla_solicitados').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                        ]
                    });

                    //$('#tabla_aprobados').dataTable({
                    //    //"ajax": 'api/datatables.json',
                    //   // dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                    //    //"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                    //    //buttons: [
                    //    //    { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },

                    //    //]
                    //});

                    $('#tabla_cotizaciones').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                        ]
                    });
                    $('#tabla_prospectos').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                        ]
                    });

                    $('#tabla_pedidos').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                        ]
                    });

                    $('#tabla_facturas').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                        ]
                    });

                    $('#tabla_matriculas').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                        ]
                    });
                }
            });
        } //ok

        function ver_det_prospectos(id) {

            if ($.fn.dataTable.isDataTable('#tabla_det_prospectos')) {
                $("#tabla_det_prospectos").dataTable().fnDestroy();
            }


            $.ajax({
                url: '/IndicadoresGraficos/buscarDetallesProspectos',
                data: {
                    fechaDesde: $('#fechaDesde').val(),
                    fechaHasta: $('#fechaHasta').val(),
                    asesor: $('#listar_asesor').val(),
                    bodega: $('#listar_bodegas').val(),
                    origen: id,
                    nuevo: $('#nuevo').val(),
                    usado: $('#usado').val(),

                },
                type: "post",
                cache: false,
                success: function (data) {

                    $('#tabla_det_prospectos').find('tbody').empty();
                    for (var i = 0; i < data.prospectos.length; i++) {
                        $('#tabla_det_prospectos').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.prospectos[i].documento + '</td><td>'
                            + data.prospectos[i].dv + '</td><td>'
                            + data.prospectos[i].cliente + '</td><td>'
                            + data.prospectos[i].telefono + '</td><td>'
                            + data.prospectos[i].celular + '</td><td>'
                            + data.prospectos[i].correo + '</td><td>'
                            + data.prospectos[i].direccion + '</td><td>'
                            + data.prospectos[i].fec_creacion + '</td><td>'
                            + data.prospectos[i].asesor + '</td><td>'
                            + data.prospectos[i].bodccs_nombre + '</td><td>'
                            + data.prospectos[i].tramite + '</td><td>'
                            + data.prospectos[i].tporigen_nombre + '</td></tr>');
                    }
                },
                complete: function (data) {
                    $('#tabla_det_prospectos').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'copy', className: 'btn-sm' },
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'pdf', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'print', className: 'btn-sm' }
                        ]
                    });
                    $('#modal_det_prospectos').modal('show');
                }
            });
        }//ok

        function PermisoVerIndicador() {
            $.ajax({
                url: '/IndicadoresGraficos/PermisoVerIndicador',
                data: {
                },
                type: "post",
                cache: false,
                success: function (data) {
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].idpermiso == 15) {
                            $('#nuevo').val(true);
                        }
                        if (data[i].idpermiso == 16) {
                            $('#usado').val(true);
                        }
                    }
                },
                complete: function (data) {
                }
            });
        }//ok

        function detalleAccesorios() {
            if ($.fn.dataTable.isDataTable('#tabla_accesorios')) {
                $("#tabla_accesorios").dataTable().fnDestroy();
            }
            $.ajax({
                url: '/IndicadoresGraficos/detalleAccesorios',
                data: {
                    fechaDesde: $('#fechaDesde').val(),
                    fechaHasta: $('#fechaHasta').val(),
                    asesor: $('#listar_asesor').val(),
                    bodega: $('#listar_bodegas').val(),
                    nuevo: $('#nuevo').val(),
                    usado: $('#usado').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {

                    if (data.info == true) {
                        $('#tabla_accesorios').find('tbody').empty();
                        $('#tabla_accesorios').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.data.cantidad + '</td><td>$'
                            + addComas(data.data.valor_total) + '</td><td>$'
                            + addComas(Math.round(data.data.share)) + '</td><tr>'
                        );
                    } else {
                        $('#tabla_accesorios').find('tbody').empty();
                    }
                }
            });
        }//ok


        function detalleCitas() {
            if ($.fn.dataTable.isDataTable('#tabla_accesorios')) {
                $("#tabla_accesorios").dataTable().fnDestroy();
            }
            $.ajax({
                url: '/IndicadoresGraficos/detalleCitas',
                data: {
                    fechaDesde: $('#fechaDesde').val(),
                    fechaHasta: $('#fechaHasta').val(),
                    asesor: $('#listar_asesor').val(),
                    bodega: $('#listar_bodegas').val(),
                    nuevo: $('#nuevo').val(),
                    usado: $('#usado').val(),
                },

                type: "post",
                cache: false,
                success: function (data) {

                    if (data.info == true) {

                        $('#tabla_cita').find('tbody').empty();
                        $('#tabla_accesorios').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.data.cantidad + '</td><td>$'
                            + addComas(data.data.valor_total) + '</td><td>$'
                            + addComas(Math.round(data.data.share)) + '</td><tr>'
                        );
                    } else {
                        $('#tabla_accesorios').find('tbody').empty();
                    }
                }
            });
        }//ok

        function detalleAccesoriosMetas() {
            if ($.fn.dataTable.isDataTable('#tabla_accesorios2')) {
                $("#tabla_accesorios2").dataTable().fnDestroy();
            }
            $.ajax({
                url: '/IndicadoresGraficos/detalleAccesorios',
                data: {
                    fechaDesde: $('#fechaDesdeMetas').val(),
                    fechaHasta: $('#fechaHastaMetas').val(),
                    asesor: $('#selectAsesor').val(),
                    bodega: $('#selectBodegas').val(),
                    nuevo: $('#nuevo').val(),
                    usado: $('#usado').val(),
                },

                type: "post",
                cache: false,
                success: function (data) {
                    $('#tabla_accesorios2').find('tbody').empty();
                    $('#tabla_accesorios2').find('tbody').append('<tr style="text-align:center"><td>'
                        + data.data.cantidad + '</td><td>$'
                        + addComas(data.data.valor_total) + '</td><td>$'
                        + addComas(Math.round(data.data.share)) + '</td><tr>'
                    );
                }
            });
        }//ok

        function tablaRanking() {
            if ($.fn.dataTable.isDataTable('#tabla_ranking')) {
                $("#tabla_ranking").dataTable().fnDestroy();
            }
            $.ajax({
                url: '/IndicadoresGraficos/tablaRanking',
                data: {
                    fechaDesde: $('#fechaDesdeRanking').val(),
                    fechaHasta: $('#fechaHastaRanking').val(),
                    bodega: $('#bodegasRanking').val(),
                },

                type: "post",
                cache: false,
                success: function (data) {
                    if (data.info == true) {
                        $('#tabla_ranking').find('tbody').empty();

                        for (var i = 0; i < data.matriculas.length; i++) {
                            var a = i + 1;
                            $('#tabla_ranking').find('tbody').append('<tr style="text-align:center"><td>'
                                + a + '</td><td>'
                                + data.matriculas[i].nombre + '</td><td>'
                                + data.matriculas[i].cantidad + '</td><tr>'
                            );
                        }
                    } else {
                        $('#mensajeErrorMatriculas').text(data.mensaje);
                        $('#divErrorMatriculas').show();

                        setTimeout(function () {
                            $("#divErrorMatriculas").fadeOut(3000);
                        }, 4500);
                    }
                }
            });
        }//ok 

        function buscarMetas() {
            $.ajax({
                url: '/IndicadoresGraficos/metasAsesor',
                data: {
                    fechaDesde: $('#fechaDesdeMetas').val(),
                    fechaHasta: $('#fechaHastaMetas').val(),
                    asesor: $('#selectAsesor').val(),
                    bodega: $('#selectBodegas').val(),
                    nuevo: $('#nuevo').val(),
                    usado: $('#usado').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    if (data.info == true) {

                        var chart = AmCharts.makeChart("chartdivProductivo", {
                            "type": "funnel",
                            "theme": "light",
                            "dataProvider":
                                [{
                                    "title": "Cotizaciones",
                                    "value": data.data.consultaCotizacion.length,
                                    "color": data.data.colorCot,
                                    "description": "\n" + "Grupo 1: Cotizaciones" + "\n" + "Cantidad: " + data.data.consultaCotizacion.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.consultaCotizacion.length / data.data.consultaCotizacion.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.consultaCotizacion.length / data.data.consultaCotizacion.length) * 100) + "%"
                                }, {
                                    "title": "Créditos Solicitados",
                                    "value": data.data.consultaCreditosSolicitados.length,
                                    "color": data.data.colorSol,
                                    "description": "\n" + "Grupo 2: Solicitados" + "\n" + "Cantidad: " + data.data.consultaCreditosSolicitados.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.consultaCreditosSolicitados.length / data.data.consultaCotizacion.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.consultaCreditosSolicitados.length / data.data.consultaCotizacion.length) * 100) + "%"
                                }, {
                                    "title": "Créditos Aprobados",
                                    "value": data.data.consultaCreditosAprobados.length,
                                    "color": data.data.colorApr,
                                    "description": "\n" + "Grupo 3: Aprobados" + "\n" + "Cantidad: " + data.data.consultaCreditosAprobados.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.consultaCreditosAprobados.length / data.data.consultaCotizacion.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.consultaCreditosAprobados.length / data.data.consultaCreditosSolicitados.length) * 100) + "%"
                                }, {
                                    "title": "Demos",
                                    "value": data.data.consultaDemos.length,
                                    "color": data.data.colorDem,
                                    "description": "\n" + "Grupo 4: Demos" + "\n" + "Cantidad: " + data.data.consultaDemos.length +
                                        "\n" + "Porcentaje con el primero: " + +parseInt((data.data.consultaDemos.length / data.data.consultaCotizacion.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.consultaDemos.length / data.data.consultaCreditosAprobados.length) * 100) + "%"
                                }, {
                                    "title": "Pedidos",
                                    "value": data.data.consultaPedidos.length,
                                    "color": data.data.colorPed,
                                    "description": "\n" + "Grupo 5: Pedidos" + "\n" + "Cantidad: " + data.data.consultaPedidos.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.consultaPedidos.length / data.data.consultaCotizacion.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.consultaPedidos.length / data.data.consultaDemos.length) * 100) + "%"
                                }, {
                                    "title": "Facturas",
                                    "value": data.data.consultaFacturas.length,
                                    "color": data.data.colorFac,
                                    "description": "\n" + "Grupo 6: Facturas" + "\n" + "Cantidad: " + data.data.consultaFacturas.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.consultaFacturas.length / data.data.consultaCotizacion.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.consultaFacturas.length / data.data.consultaPedidos.length) * 100) + "%"
                                }, {
                                    "title": "Matrículas",
                                    "value": data.data.consultaMatriculas.length,
                                    "color": data.data.colorMat,
                                    "description": "\n" + "Grupo 7: Matrículas" + "\n" + "Cantidad: " + data.data.consultaMatriculas.length +
                                        "\n" + "Porcentaje con el primero: " + parseInt((data.data.consultaMatriculas.length / data.data.consultaCotizacion.length) * 100) + "%" +
                                        "\n" + "Porcentaje con el anterior: " + parseInt((data.data.consultaMatriculas.length / data.data.consultaFacturas.length) * 100) + "%"
                                }],

                            "valueField": "value",
                            "titleField": "title",
                            "colorField": "color",
                            "descriptionField": "description",
                            "marginRight": 240,
                            "marginLeft": 50,
                            "startX": -500,
                            "depth3D": 100,
                            "angle": 10,
                            "outlineColor": "#ffffff",
                            "outlineThickness": 2,
                            "labelPosition": "right",
                            "balloonText": "[[description]]",
                            "balloon": {
                                "fixedPosition": true,
                                "textAlign": "left",
                                "maxWidth": "auto"
                            },
                            "AmSlicedChart": {
                                "accessible": false
                            }
                        });
                    } else {
                        $('#mensajeError').text(data.mensaje);
                        $('#divError').show();

                        setTimeout(function () {
                            $("#divError").fadeOut(1500);
                        }, 3000);
                        setTimeout(function () {
                            $("#mensajeError").fadeOut(1500);
                        }, 3000);
                    }
                }
            });
        }//ok

        function buscarMetasFijas() {
            var dataProvider_array = [];
            $.ajax({
                url: '/IndicadoresGraficos/metasAsesor',

                data: {
                    fechaDesde: $('#fechaDesdeMetas').val(),
                    fechaHasta: $('#fechaHastaMetas').val(),
                    asesor: $('#selectAsesor').val(),
                    bodega: $('#selectBodegas').val(),
                    usado: $('#usado').val(),
                    nuevo: $('#nuevo').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    if (data.info == true) {
                        for (var i = 0; i < data.data.consultaMetas.length; i++) {
                            dataProvider_array.push(JSON.parse('{"title":"' + data.data.consultaMetas[i].meta + '","value":' + data.data.consultaMetas[i].valor + "}"));
                        }

                        var chart = AmCharts.makeChart("chartdivMetas", {

                            "type": "funnel",
                            "theme": "light",
                            "dataProvider": dataProvider_array,

                            "valueField": "value",
                            "titleField": "title",
                            "descriptionField": "description",
                            "marginRight": 240,
                            "marginLeft": 50,
                            "startX": -500,
                            "depth3D": 100,
                            "angle": 10,
                            "outlineColor": "#ffffff",
                            "outlineThickness": 2,
                            "labelPosition": "right",
                            "balloonText": "[[description]]",
                            "balloon": {
                                "fixedPosition": true,
                                "textAlign": "left",
                                "maxWidth": "auto"
                            },
                            "AmSlicedChart": {
                                "accessible": false
                            }
                        });
                    } else {
                        $('#mensajeError').text(data.mensaje);
                        $('#divError').show();

                        setTimeout(function () {
                            $("#divError").fadeOut(1500);
                        }, 3000);
                        setTimeout(function () {
                            $("#mensajeError").fadeOut(1500);
                        }, 3000);
                    }
                }
            });
        }//ok

        function buscarbodegasMetas() {
            $.ajax({
                url: '/IndicadoresGraficos/BuscarBodegas',
                data: {
                },
                type: "post",
                cache: false,
                success: function (data) {
                    $('#selectBodegas').empty();
                    $('#selectBodegas').append($('<option>', {
                        value: '',
                        text: ''
                    }));
                    for (var i = 0; i < data.length; i++) {
                        $('#selectBodegas').append($('<option>', {
                            value: data[i].id,
                            text: data[i].bodccs_nombre
                        }));
                    }
                }
            });
        }//ok

        function buscarAsesorMetas() {
            $.ajax({
                url: '/IndicadoresGraficos/listarAsesorPorBodega',
                data: {
                    param: $('#selectBodegas').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    $('#selectAsesor').empty();
                    for (var i = 0; i < data.length; i++) {
                        $('#selectAsesor').append($('<option>', {
                            value: data[i].user_id,
                            text: data[i].nombre
                        }));
                    }
                }
            });
        } //ok

        function Share() {
            $.ajax({
                url: '/IndicadoresGraficos/metasAsesor',
                data: {
                    fechaDesde: $('#fechaDesdeMetas').val(),
                    fechaHasta: $('#fechaHastaMetas').val(),
                    asesor: $('#selectAsesor').val(),
                    bodega: $('#selectBodegas').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    if (data.info == true) {
                        $('#share').text(addComas('META SHARE ACCESORIOS: ' + '$' + data.data.consultaMetaShare[0].valor));
                    }
                }
            });
        } //ok

        function buscarPronostico() {
            $.ajax({
                url: '/IndicadoresGraficos/pronostico',
                data: {
                    fechaHasta: $('#fechaHastaMetas').val(),
                    asesor: $('#selectAsesor').val(),
                    bodega: $('#selectBodegas').val(),
                    nuevo: $('#nuevo').val(),
                    usado: $('#usado').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    if (data.info == true) {

                        var chart = AmCharts.makeChart("chartdivPronostico", {
                            "type": "funnel",
                            "theme": "light",
                            "dataProvider":
                                [{
                                    "title": "Cotizaciones",
                                    "value": data.data.cotizacion,
                                }, {
                                    "title": "Créditos Solicitados",
                                    "value": data.data.creditosSolicitados,
                                }, {
                                    "title": "Créditos Aprobados",
                                    "value": data.data.creditosAprobados,
                                }, {
                                    "title": "Demos",
                                    "value": data.data.demos,
                                }, {
                                    "title": "Facturas",
                                    "value": data.data.facturas,
                                }, {
                                    "title": "Matrículas",
                                    "value": data.data.matriculas,
                                }, {
                                    "title": "Pedidos",
                                    "value": data.data.pedidos,
                                }],

                            "valueField": "value",
                            "titleField": "title",
                            "colorField": "color",
                            "descriptionField": "description",
                            "marginRight": 240,
                            "marginLeft": 50,
                            "startX": -500,
                            "depth3D": 100,
                            "angle": 10,
                            "outlineColor": "#ffffff",
                            "outlineThickness": 2,
                            "labelPosition": "right",
                            "balloonText": "[[description]]",
                            "balloon": {
                                "fixedPosition": true,
                                "textAlign": "left",
                                "maxWidth": "auto"
                            },
                            "AmSlicedChart": {
                                "accessible": false
                            }
                        });
                    } else {
                        $('#mensajeError').text(data.mensaje);
                        $('#divError').show();

                        setTimeout(function () {
                            $("#divError").fadeOut(1500);
                        }, 3000);
                        setTimeout(function () {
                            $("#mensajeError").fadeOut(1500);
                        }, 3000);
                    }
                }
            });
        }
        function buscarEntradasAnfitriona() {
            $.ajax({
                url: '/IndicadoresGraficos/EntradasAnfitriona',
                data: {
                    fechaDesde: $('#fechaDesde').val(),
                    fechaHasta2: $('#fechaHasta').val(),
                    bodega: $('#listar_bodegas').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    console.log(data)
                    $('#tabla_anfitriona_coordinador').show()
                    $('#tabla_anfitriona_coordinador').find('tbody').empty()
                    $('#tabla_anfitriona_asesor').hide()
                    if (data.coordinador == true) {
                        for (var i = 0; i < data.data.prospectos.length; i++) {
                            $('#tabla_anfitriona_coordinador').find('tbody').append(
                                '<tr>'
                                + '<td>' + data.data.prospectos[i].bodega + '</td>'
                                + '<td align="right">' + data.data.prospectos[i].cantidad + '</td>'
                                + '<td align="right">' + data.data.prospectos[i].credito + '</td>'
                                + '</tr>'
                            );
                        }
                    }
                    if (data.asesor == true) {
                        for (var i = 0; i < data.data.prospectos.length; i++) {
                            $('#tabla_anfitriona_coordinador').find('tbody').append(
                                '<tr>'
                                + '<td>' + data.data.prospectos[i].bodega + '</td>'
                                + '<td align="right">' + data.data.prospectos[i].cantidad + '</td>'
                                + '<td align="right">' + data.data.prospectos[i].credito + '</td>'
                                + '</tr>'
                            )
                        }
                    }
                },
                complete: function (data) {
                    buscarEntradasCitas();
                }
            });
        }

        function buscarEntradasCitas() {
            $.ajax({
                url: '/IndicadoresGraficos/buscarCitasPorVitrina',
                data: {
                    fechaDesde: $('#fechaDesde').val(),
                    fechaHasta: $('#fechaHasta').val(),
                    bodega: $('#listar_bodegas').val(),
                    asesor: $('#listar_asesor').val(),
                    bodega: $('#listar_bodegas').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    console.log(data)
                    $('#tabla_agendamiento_citas').find('tbody').empty()
                    for (var i = 0; i < data.length; i++) {
                        $('#tabla_agendamiento_citas').find('tbody').append(
                            '<tr>'
                            + '<td>' + data[i].nombrevitrina + '</td>'
                            + '<td align="right">' + data[i].atendido + '</td>'
                            + '<td align="right">' + data[i].cancelado + '</td>'
                            + '</tr>'
                        );
                    }
                },
                 complete: function (data) {

                }
            });
        }

        function getRandomColor() {
            color = '#'
            var letters = '0123456789ABCDEF';
            for (var i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        function grafico(anio_matrilculas) {
            getRandomColor()
            $.ajax({
                url: '/IndicadoresGraficos/buscarMatriculas',
                data: {
                    anio_matriculas: parseInt(anio_matrilculas),
                },
                type: 'POST',
                cache: false,
                success: function (data) {
                    var array = []
                    if (data.asesor == true) {
                        var config = {
                            type: 'line',
                            data: {
                                labels: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                                datasets: [{
                                    label: data.data.buscarAsesor.nombre,
                                    backgroundColor: color,
                                    borderColor: color,
                                    data: [
                                        data.data.buscarMatriculas[0].enero,
                                        data.data.buscarMatriculas[0].febrero,
                                        data.data.buscarMatriculas[0].marzo,
                                        data.data.buscarMatriculas[0].abril,
                                        data.data.buscarMatriculas[0].mayo,
                                        data.data.buscarMatriculas[0].junio,
                                        data.data.buscarMatriculas[0].julio,
                                        data.data.buscarMatriculas[0].agosto,
                                        data.data.buscarMatriculas[0].septiembre,
                                        data.data.buscarMatriculas[0].octubre,
                                        data.data.buscarMatriculas[0].noviembre,
                                        data.data.buscarMatriculas[0].diciembre
                                    ],
                                    fill: false,
                                }]
                            },
                            options: {
                                responsive: true,
                                title: {
                                    display: true,
                                    text: 'Matrículas'
                                },
                                tooltips: {
                                    mode: 'index',
                                    intersect: false,
                                },
                                hover: {
                                    mode: 'nearest',
                                    intersect: true
                                },
                                scales: {
                                    xAxes: [{
                                        display: true,
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'Meses'
                                        }
                                    }],
                                    yAxes: [{
                                        display: true,
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'Matrículas'
                                        },
                                        ticks: {
                                            min: 0,
                                            max: 20,
                                            stepSize: 1,
                                            reverse: false,
                                        },
                                    }]
                                }
                            }
                        };
                        var ctx = document.getElementById('canvas').getContext('2d');
                        window.myLine = new Chart(ctx, config);
                    }
                    if (data.coordinador == true) {
                        for (var i = 0; i < data.listaConsulta.length; i++) {
                            array[i] = {
                                label: data.listaConsulta[i].nombre,
                                backgroundColor: getRandomColor(),
                                borderColor: color,
                                data: [
                                    data.listaConsulta[i].enero,
                                    data.listaConsulta[i].febrero,
                                    data.listaConsulta[i].marzo,
                                    data.listaConsulta[i].abril,
                                    data.listaConsulta[i].mayo,
                                    data.listaConsulta[i].junio,
                                    data.listaConsulta[i].julio,
                                    data.listaConsulta[i].agosto,
                                    data.listaConsulta[i].septiembre,
                                    data.listaConsulta[i].octubre,
                                    data.listaConsulta[i].noviembre,
                                    data.listaConsulta[i].diciembre
                                ],
                                fill: false,
                            }
                        }
                        console.log(array)
                        var config = {
                            type: 'line',
                            data: {
                                labels: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                                datasets: array,
                            },
                            options: {
                                responsive: true,
                                title: {
                                    display: true,
                                    text: 'Matrículas'
                                },
                                tooltips: {
                                    mode: 'index',
                                    intersect: false,
                                },
                                hover: {
                                    mode: 'nearest',
                                    intersect: true
                                },
                                scales: {
                                    xAxes: [{
                                        display: true,
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'Meses'
                                        }
                                    }],
                                    yAxes: [{
                                        display: true,
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'Matrículas'
                                        },
                                        ticks: {
                                            min: 0,
                                            max: 3,
                                            stepSize: 1,
                                            reverse: false,
                                        },
                                    }]
                                }
                            }
                        };

                        var ctx = document.getElementById('canvas').getContext('2d');
                        window.myLine = new Chart(ctx, config);
                    }
                    if (data.director == true) {
                        for (var i = 0; i < data.listaConsulta.length; i++) {
                            array[i] = {
                                label: data.listaConsulta[i].nombre,
                                backgroundColor: getRandomColor(),
                                borderColor: color,
                                data: [
                                    data.listaConsulta[i].enero,
                                    data.listaConsulta[i].febrero,
                                    data.listaConsulta[i].marzo,
                                    data.listaConsulta[i].abril,
                                    data.listaConsulta[i].mayo,
                                    data.listaConsulta[i].junio,
                                    data.listaConsulta[i].julio,
                                    data.listaConsulta[i].agosto,
                                    data.listaConsulta[i].septiembre,
                                    data.listaConsulta[i].octubre,
                                    data.listaConsulta[i].noviembre,
                                    data.listaConsulta[i].diciembre
                                ],
                                fill: false,
                            }
                        }
                        console.log(array)
                        var config = {
                            type: 'line',
                            data: {
                                labels: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                                datasets: array,
                            },
                            options: {
                                responsive: true,
                                title: {
                                    display: true,
                                    text: 'Matrículas'
                                },
                                tooltips: {
                                    mode: 'index',
                                    intersect: false,
                                },
                                hover: {
                                    mode: 'nearest',
                                    intersect: true
                                },
                                scales: {
                                    xAxes: [{
                                        display: true,
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'Meses'
                                        }
                                    }],
                                    yAxes: [{
                                        display: true,
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'Matrículas'
                                        },
                                        ticks: {
                                            min: 0,
                                            max: 100,
                                            stepSize: 10,
                                            reverse: false,
                                        },
                                    }]
                                }
                            }
                        }

                        var ctx = document.getElementById('canvas').getContext('2d');
                        window.myLine = new Chart(ctx, config);
                    }
                }
            });
        }

    </script>
}
