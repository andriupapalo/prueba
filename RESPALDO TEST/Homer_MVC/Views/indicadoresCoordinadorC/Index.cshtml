@{
    ViewBag.Title = "Indicadores";
    ViewBag.Icono = "fa fa-bar-chart";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@section Styles {
    @Styles.Render("~/bundles/select2/css")
}
<!-- App styles -->
<link href="~/Vendor/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />
<link rel="stylesheet" href="~/vendor/chartist/custom/chartist.css" />
<link href="~/Vendor/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet" />

<div class="panel-body">
    <div class="panel-heading" style="background-color:white;  border:solid 1px; border-color:#e4e5e7">
        <div class="panel-body">

            <div id="hbreadcrumb" class="pull-right">

                <button type="button" class="btn btn-mini btn-default" style="border-radius:25px" data-container="body" data-toggle="popover" data-placement="left" data-title="Enlaces" data-content="<ul>@ViewBag.nombreEnlaces</ul>" data-html="true">
                    <i class="text-info fa fa-tags"></i>
                </button>
                <button type="button" class="btn btn-mini btn-default" style="border-radius:25px" data-container="body" data-toggle="popover" data-placement="left" data-title="Documentos" data-content="<ul></i><a href=''>Documento 1</a></ul>  <ul></i><a href=''>Documento 2</a></ul> <ul></i><a href=''>Documento 3</a></ul>" data-html="true">
                    <i class="text-primary fa fa-files-o"></i>
                </button>
                <button class="btn btn-mini btn-default" style="border-radius:25px">
                    <i class="text-warning fa fa-star"></i>
                </button>

            </div>
            <h3 class="font-light m-b-xs">
                <i class="text-info @ViewBag.Icono"></i>&nbsp;&nbsp;@ViewBag.Title
            </h3>
            <small>Registro @ViewBag.Title</small>
        </div>
    </div>
</div>

<div class="content">
    <div class="panel-body">

        <div class="col-sm-5">
            <div class="form-group">
                @*<label class="control-label col-md-4">Rango Fechas:&nbsp;</label>*@
                <div class="col-md-12">
                    <div class="input-daterange input-group" id="datepicker">
                        <input type="text" class="input-sm form-control" name="fechaDesde" id="fechaDesde" placeholder="Fecha Inicio" />
                        <span class="input-group-addon">Hasta</span>
                        <input type="text" class="input-sm form-control" name="fechaHasta" id="fechaHasta" placeholder="Fecha Fin" />
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-5">
            <div class="form-group">
                <label class="control-label col-md-1">Asesor:</label>
                <div class="col-md-12">
                    <select id="listar_asesor" name="listar_asesor" multiple="multiple" required="required" class="form-control js-source-states" placeholder="Seleción múltiple"></select>
                    @*@Html.DropDownList("asesor", null, "", htmlAttributes: new { @multiple = "multiple", @class = "form-control js-source-states", @placeholder = "Asesor", })*@
                </div>
                <div class="col-md-12">
                    <select id="listar_asesor" name="listar_asesor" multiple="multiple" required="required" class="form-control js-source-states" placeholder="Seleción múltiple"></select>
                    @*@Html.DropDownList("asesor", null, "", htmlAttributes: new { @multiple = "multiple", @class = "form-control js-source-states", @placeholder = "Asesor", })*@
                </div>
            </div>
        </div>

        <div class="col-md-2">
            <button type="button" class="btn btn-primary" id="btnFiltrar"><i class="fa fa-filter" aria-hidden="true"></i>&nbsp;&nbsp;Filtrar</button>
        </div>

        <div class="col-sm-12">
            <div class="panel-body">

                <center><div id="chartdiv" style="width:60%;height:400px"></div></center>
            </div>
        </div>
    </div>
</div>

@*============= modal solicitados ===================*@
<div class="modal fade hmodal-info" id="modal_creditos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Creditos Solicitados</h4>
                <small class="font-bold">Detalle de creditos solicitados</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <div id="div-mensaje-buscar">
                        <span class="font-bold">Estados Creditos:</span>&nbsp;&nbsp;
                        <label class="label label-warning">T</label>&nbsp;Tramite&nbsp;&nbsp;
                        <label class="label label-success">A</label>&nbsp;Aprobado&nbsp;&nbsp;
                        <label class="label label-danger">N</label>&nbsp;Negado&nbsp;&nbsp;
                        <label class="label label-primary">C</label>&nbsp;Confirmado&nbsp;&nbsp;
                        <label class="label label-info">D</label>&nbsp;Desembolsado&nbsp;&nbsp;
                        <label class="label label-default">O</label>&nbsp;Desistio&nbsp;&nbsp;
                    </div><br />
                    <table class="table table-striped table-bordered table-hover" id="tabla_solicitados">
                        <thead>
                            <tr>
                                <th style="text-align:center">Pedido #</th>
                                <th style="text-align:center">Fecha Solicitud</th>
                                <th style="text-align:center">Valor Solicitado</th>
                                <th style="text-align:center">Estado Credito</th>
                                <th style="text-align:center">Plazo</th>
                                <th style="text-align:center">Financiera</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Asesor</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal cotizaciones ===================*@
<div class="modal fade hmodal-warning" id="modal_cotizaciones" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Cotizaciones</h4>
                <small class="font-bold">Detalle de cotizaciones</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_cotizaciones">
                        <thead>
                            <tr>
                                <th style="text-align:center">Cotizacion #</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Origen</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                @*<button type="button" class="btn btn-primary" data-dismiss="modal">Aceptar</button>*@
            </div>
        </div>
    </div>
</div>

@*============= modal prospectos ===================*@
<div class="modal fade hmodal-primary" id="modal_prospectos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Prospectos</h4>
                <small class="font-bold">Detalle de prospectos por fuente</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_prospectos">
                        <thead>
                            <tr>
                                <th style="text-align:center">Origen</th>
                                <th style="text-align:center">Cantidad</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal pedidos ===================*@
<div class="modal fade hmodal-success" id="modal_pedidos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Pedidos</h4>
                <small class="font-bold">Detalle de pedidos</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_pedidos">
                        <thead>
                            <tr>
                                <th style="text-align:center">Pedido #</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Modelo</th>
                                <th style="text-align:center">Año Modelo</th>
                                <th style="text-align:center">Color</th>
                                <th style="text-align:center">Placa</th>
                                <th style="text-align:center">Plan Venta</th>
                                <th style="text-align:center">Plan Mayor</th>
                                <th style="text-align:center">Fecha Asignacion</th>
                                <th style="text-align:center">Valor Total</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Cliente</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal aprobados ===================*@
<div class="modal fade hmodal-success" id="modal_aprobados" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Aprobados</h4>
                <small class="font-bold">Detalle De Aprobados</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_aprobados">
                        <thead>
                            <tr>
                                <th style="text-align:center">Pedido #</th>
                                <th style="text-align:center">Fecha Solicitud</th>
                                <th style="text-align:center">Valor Solicitado</th>
                                <th style="text-align:center">Plazo</th>
                                <th style="text-align:center">Financiera</th>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Asesor</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal demos ===================*@
<div class="modal fade hmodal-success" id="modal_demos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Demos</h4>
                <small class="font-bold">Detalle De Demos</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_demos">
                        <thead>
                            <tr>
                                <th style="text-align:center">Demo</th>
                                <th style="text-align:center">Descripción</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Documento</th>
                                <th style="text-align:center">Nombre</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Teléfono</th>
                                <th style="text-align:center">Asesor</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal facturas ===================*@
<div class="modal fade hmodal-info" id="modal_facturas" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Facturas</h4>
                <small class="font-bold">Detalle de facturas</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_facturas">
                        <thead>
                            <tr>
                                <th style="text-align:center">Factura #</th>
                                <th style="text-align:center">Tipo Factura</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Tercero</th>
                                <th style="text-align:center">Financiera</th>
                                <th style="text-align:center">Forma Pago</th>
                                <th style="text-align:center">Fecha Vencimiento</th>
                                <th style="text-align:center">Valor Total</th>
                                <th style="text-align:center">Asesor</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal matriculas ===================*@
<div class="modal fade hmodal-info" id="modal_matriculas" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Matriculas</h4>
                <small class="font-bold">Detalle de matriculas</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_matriculas">
                        <thead>
                            <tr>
                                <th style="text-align:center">Fecha Matricula</th>
                                <th style="text-align:center">Plan Mayor</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@*============= modal detalle prospectos ===================*@
<div class="modal fade hmodal-primary" id="modal_det_prospectos" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="color-line"></div>
            <div class="modal-header text-center">
                <h4 class="modal-title">Prospectos</h4>
                <small class="font-bold">Detalle de prospectos por fuente</small><br />
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="tabla_det_prospectos">
                        <thead>
                            <tr>
                                <th style="text-align:center">Cliente</th>
                                <th style="text-align:center">Razon Social</th>
                                <th style="text-align:center">Documento</th>
                                <th style="text-align:center">Telefono</th>
                                <th style="text-align:center">Celular</th>
                                <th style="text-align:center">Correo</th>
                                <th style="text-align:center">Direccion</th>
                                <th style="text-align:center">Fecha</th>
                                <th style="text-align:center">Asesor</th>
                                <th style="text-align:center">Tramite</th>
                                <th style="text-align:center">Fuente</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>



<!-- Vendor scripts -->
@section Scripts {
    @Scripts.Render("~/bundles/select2/js")
    <script src="~/Vendor/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="~/Vendor/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
    <script src="~/Vendor/datatablesExcelExport/dataTable1.4.0-buttons.js"></script>
    <script src="~/Vendor/datatablesExcelExport/JSZip3.1.3.min.js"></script>
    <script src="~/Vendor/pdfmake/build/pdfmake.min.js"></script>
    <script src="~/Vendor/pdfmake/build/vfs_fonts.js"></script>
    <script src="~/Vendor/datatablesExcelExport/jsZipDataTables.js"></script>

    <script src="~/vendor/d3/d3.min.js"></script>
    <script src="~/vendor/c3/c3.min.js"></script>

    <!-- App scripts -->
    <script src="~/Scripts/homer.js"></script>
    @*<script src="~/Scripts/charts.js"></script>*@
    <script src="~/Vendor/moment/min/moment.min.js"></script>
    <script src="~/Vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    <script src="~/Vendor/AmCharts/lib/3/amcharts.js"></script>
    <script src="~/Vendor/AmCharts/lib/3/funnel.js"></script>
    <link href="~/Vendor/AmCharts/lib/3/plugins/export/export.css" rel="stylesheet" />
    <script src="~/Vendor/AmCharts/lib/3/plugins/export/export.min.js"></script>
    <script src="~/Vendor/AmCharts/lib/3/themes/light.js"></script>
    <script>

        $(document).ready(function () {
            $('.js-source-states').select2();
            listar_asesor();
            var fecha = '@DateTime.Now.AddDays(-30)';
            var fecha2 = '@DateTime.Now';

            $('#fechaDesde').val(fecha);
            $('#fechaHasta').val(fecha2);
            $('#fechaDesde').datetimepicker({
                format: 'DD/MM/YYYY',
            });
            $('#fechaHasta').datetimepicker({
                format: 'DD/MM/YYYY',
                maxDate: '-' + new Date() + '',
            });

            buscarDatos();
        });

        $('#btnFiltrar').click(function () {
            buscarDatos()
        });

        function buscarDatos() {
            $.ajax({
                url: '/indicadoresCoordinadorC/buscarDatos',

                data: {
                    fechaDesde: $('#fechaDesde').val(),
                    fechaHasta: $('#fechaHasta').val(),
                    //financiera: $('#financiera').val(),
                    asesor: $('#asesor').val(),
                },
                type: "post",
                cache: false,
                success: function (data) {
                    console.log(data)
                    var chart = AmCharts.makeChart("chartdiv", {
                        "type": "funnel",
                        "theme": "light",
                        "dataProvider":
                            [{
                                "title": "Prospectos",
                                "value": data.cantidadProspectos.lengths
                            }, {
                                "title": "Cotizaciones",
                                "value": data.cotizaciones.length,
                                "description": "\n" + "Grupo 1: Cotizaciones" + "\n" + "Cantidad: " + data.cotizaciones.length +
                                    "\n" + "Porcentaje con el primero: " + parseInt((data.cotizaciones.length / data.cotizaciones.length) * 100) + "%" +
                                    "\n" + "Porcentaje con el anterior: " + parseInt((data.cotizaciones.length / data.cotizaciones.length) * 100) + "%"
                            }, {
                                "title": "Créditos Solicitados",
                                "value": data.solicitados.length,
                                "description": "\n" + "Grupo 2: Solicitados" + "\n" + "Cantidad: " + data.solicitados.length +
                                    "\n" + "Porcentaje con el primero: " + parseInt((data.solicitados.length / data.cotizaciones.length) * 100) + "%" +
                                    "\n" + "Porcentaje con el anterior: " + parseInt((data.solicitados.length / data.cotizaciones.length) * 100) + "%"
                            }, {
                                "title": "Créditos Aprobados",
                                "value": data.aprobados.length,
                                "description": "\n" + "Grupo 3: Aprobados" + "\n" + "Cantidad: " + data.aprobados.length +
                                    "\n" + "Porcentaje con el primero: " + parseInt((data.aprobados.length / data.cotizaciones.length) * 100) + "%" +
                                    "\n" + "Porcentaje con el anterior: " + parseInt((data.aprobados.length / data.solicitados.length) * 100) + "%"
                            }, {
                                "title": "Demos",
                                "value": data.demos.length,
                                "description": "\n" + "Grupo 4: Demos" + "\n" + "Cantidad: " + data.demos.length +
                                    "\n" + "Porcentaje con el primero: " + +parseInt((data.demos.length / data.cotizaciones.length) * 100) + "%" +
                                    "\n" + "Porcentaje con el anterior: " + parseInt((data.demos.length / data.aprobados.length) * 100) + "%"
                            }, {
                                "title": "Pedidos",
                                "value": data.pedidos.length,
                                "description": "\n" + "Grupo 5: Pedidos" + "\n" + "Cantidad: " + data.pedidos.length +
                                    "\n" + "Porcentaje con el primero: " + parseInt((data.pedidos.length / data.cotizaciones.length) * 100) + "%" +
                                    "\n" + "Porcentaje con el anterior: " + parseInt((data.pedidos.length / data.demos.length) * 100) + "%"
                            }, {
                                "title": "Facturas",
                                "value": data.facturas.length,
                                "description": "\n" + "Grupo 6: Facturas" + "\n" + "Cantidad: " + data.facturas.length +
                                    "\n" + "Porcentaje con el primero: " + parseInt((data.facturas.length / data.cotizaciones.length) * 100) + "%" +
                                    "\n" + "Porcentaje con el anterior: " + parseInt((data.facturas.length / data.pedidos.length) * 100) + "%"
                            }, {
                                "title": "Matrículas",
                                "value": data.matriculas.length,
                                "description": "\n" + "Grupo 7: Matrículas" + "\n" + "Cantidad: " + data.matriculas.length +
                                    "\n" + "Porcentaje con el primero: " + parseInt((data.matriculas.length / data.cotizaciones.length) * 100) + "%" +
                                    "\n" + "Porcentaje con el anterior: " + parseInt((data.matriculas.length / data.facturas.length) * 100) + "%"
                            }],

                        "valueField": "value",
                        "titleField": "title",
                        "descriptionField": "description",
                        "marginRight": 240,
                        "marginLeft": 50,
                        "startX": -500,
                        "depth3D": 100,
                        "angle": 10,
                        "outlineColor": "#ffffff",
                        "outlineThickness": 2,
                        "labelPosition": "right",
                        "balloonText": "[[description]]",
                        "balloon": {
                            "fixedPosition": true,
                            "textAlign": "left",
                            "maxWidth": "auto"
                        },
                        "AmSlicedChart": {
                            "accessible": false
                        }
                    });

                    chart.addListener("clickSlice", function (event, index) {
                        var posicion = event.dataItem.index;
                        if (posicion == 0) {
                            $('#modal_prospectos').modal('show')
                        } else if (posicion == 1) {
                            $('#modal_cotizaciones').modal('show');
                        } else if (posicion == 2) {
                            $('#modal_creditos').modal('show');
                        } else if (posicion == 3) {
                            $('#modal_aprobados').modal('show');
                        } else if (posicion == 4) {
                            $('#modal_demos').modal('show');
                        } else if (posicion == 5) {
                            $('#modal_pedidos').modal('show');
                        } else if (posicion == 6) {
                            $('#modal_facturas').modal('show');
                        } else if (posicion == 7) {
                            $('#modal_matriculas').modal('show');
                        }
                    });

                    var funnelData = {

                        modals: [
                            "modal_prospectos",
                            "modal_cotizaciones",
                            "modal_aprobados",
                            "modal_demos",
                            "modal_creditos",
                            "modal_pedidos",
                            "modal_facturas",
                            "modal_matriculas"
                        ],
                    };


                    $("#tabla_solicitados").dataTable().fnDestroy();
                    $('#tabla_solicitados').find('tbody').empty();
                    for (var i = 0; i < data.solicitados.length; i++) {
                        $('#tabla_solicitados').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.solicitados[i].pedido + '</td><td>'
                            + data.solicitados[i].fecha_solicitud + '</td><td>$'
                            + addComas(data.solicitados[i].valor_solicitado) + '</td><td>'
                            + data.solicitados[i].estado + '</td><td>'
                            + data.solicitados[i].plazo + '</td><td>'
                            + data.solicitados[i].financiera + '</td><td>'
                            + data.solicitados[i].cliente + '</td><td>'
                            + data.solicitados[i].asesor + '</td></tr>');
                    }

                    $('#tabla_aprobados').find('tbody').empty();
                    for (var i = 0; i < data.aprobados.length; i++) {
                        $('#tabla_aprobados').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.aprobados[i].numero + '</td><td>'
                            + data.aprobados[i].fec_solicitud + '</td><td>'
                            + addComas(data.aprobados[i].vsolicitado) + '</td><td>'
                            + data.aprobados[i].plazo + '</td><td>'
                            + data.aprobados[i].financiera_nombre + '</td><td>'
                            + data.aprobados[i].nombre + '</td><td>'
                            + data.aprobados[i].nombreAsesor + '</td><tr>');
                    }

                    $("#tabla_cotizaciones").dataTable().fnDestroy();
                    $('#tabla_cotizaciones').find('tbody').empty();
                    for (var i = 0; i < data.cotizaciones.length; i++) {
                        $('#tabla_cotizaciones').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.cotizaciones[i].numero + '</td><td>'
                            + data.cotizaciones[i].fecha + '</td><td>'
                            + data.cotizaciones[i].asesor + '</td><td>'
                            + data.cotizaciones[i].cliente + '</td><td>'
                            + data.cotizaciones[i].origen + '</td></tr>')
                    }

                    $('#tabla_demos').find('tbody').empty();
                    for (var i = 0; i < data.demos.length; i++) {
                        $('#tabla_demos').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.demos[i].ref_codigo + '</td><td>'
                            + data.demos[i].ref_descripcion + '</td><td>'
                            + data.demos[i].desde + '</td><td>'
                            + data.demos[i].ncliente + '</td><td>'
                            + data.demos[i].nombre + '</td><td>'
                            + data.demos[i].celular + '</td><td>'
                            + data.demos[i].correo + '</td><td>'
                            + data.demos[i].telefono + '</td><td>'
                            + data.demos[i].asesor + '</td></tr>')
                    }

                    $("#tabla_prospectos").dataTable().fnDestroy();
                    $('#tabla_prospectos').find('tbody').empty();
                    for (var i = 0; i < data.prospectos.length; i++) {
                        $('#tabla_prospectos').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.prospectos[i].origen + '</td><td><button type="button" onclick="ver_det_prospectos(' + data.prospectos[i].id + ')" class="btn btn-info btn-xs" >'
                            + data.prospectos[i].cantidad + '</button></td></tr>')
                    }

                    $("#tabla_pedidos").dataTable().fnDestroy();
                    $('#tabla_pedidos').find('tbody').empty();
                    for (var i = 0; i < data.pedidos.length; i++) {
                        $('#tabla_pedidos').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.pedidos[i].numero + '</td><td>'
                            + data.pedidos[i].fecha + '</td><td>'
                            + data.pedidos[i].modelo + '</td><td>'
                            + data.pedidos[i].anio_modelo + '</td><td>'
                            + data.pedidos[i].color + '</td><td>'
                            + data.pedidos[i].placa + '</td><td>'
                            + data.pedidos[i].plan_venta + '</td><td>'
                            + data.pedidos[i].plan_mayor + '</td><td>'
                            + data.pedidos[i].fecha_plan_mayor + '</td><td>$'
                            + addComas(data.pedidos[i].valor_total) + '</td><td>'
                            + data.pedidos[i].asesor + '</td><td>'
                            + data.pedidos[i].cliente + '</td></tr>')
                    }

                    $("#tabla_facturas").dataTable().fnDestroy();
                    $('#tabla_facturas').find('tbody').empty();
                    for (var i = 0; i < data.facturas.length; i++) {
                        $('#tabla_facturas').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.facturas[i].numero + '</td><td>'
                            + data.facturas[i].tipo + '</td><td>'
                            + data.facturas[i].fecha + '</td><td>'
                            + data.facturas[i].tercero + '</td><td>'
                            + data.facturas[i].financiera + '</td><td>'
                            + data.facturas[i].forma_pago + '</td><td>'
                            + data.facturas[i].fecha_vencimiento + '</td><td>$'
                            + addComas(data.facturas[i].valor_total) + '</td><td>'
                            + data.facturas[i].vendedor + '</td></tr>')
                    }

                    $("#tabla_matriculas").dataTable().fnDestroy();
                    $('#tabla_matriculas').find('tbody').empty();
                    for (var i = 0; i < data.matriculas.length; i++) {
                        $('#tabla_matriculas').find('tbody').append('<tr style="text-align:center"><td>'
                            + data.matriculas[i].fecha + '</td><td>'
                            + data.matriculas[i].plan_mayor + '</td></tr>')
                    }
                },
                complete: function (data) {

                    $('#tabla_solicitados').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'copy', className: 'btn-sm' },
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'pdf', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'print', className: 'btn-sm' }
                        ]
                    });

                    $('#tabla_cotizaciones').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'copy', className: 'btn-sm' },
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'pdf', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'print', className: 'btn-sm' }
                        ]
                    });

                    $('#tabla_prospectos').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'copy', className: 'btn-sm' },
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'pdf', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'print', className: 'btn-sm' }
                        ]
                    });

                    $('#tabla_pedidos').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'copy', className: 'btn-sm' },
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'pdf', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'print', className: 'btn-sm' }
                        ]
                    });

                    $('#tabla_facturas').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'copy', className: 'btn-sm' },
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'pdf', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'print', className: 'btn-sm' }
                        ]
                    });

                    $('#tabla_matriculas').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'copy', className: 'btn-sm' },
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'pdf', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'print', className: 'btn-sm' }
                        ]
                    });
                }
            });
        }

        function ver_det_prospectos(idorigen) {

            $.ajax({
                url: '/indicadoresCoordinadorC/buscarDetallesProspectos',
                data: {
                    fechaDesde: $('#fechaDesde').val(),
                    fechaHasta: $('#fechaHasta').val(),
                    asesor: $('#asesor').val(),
                    origen: idorigen,
                },
                type: "post",
                cache: false,
                success: function (data) {
                    $("#tabla_det_prospectos").dataTable().fnDestroy();
                    $('#tabla_det_prospectos').find('tbody').empty();
                    for (var i = 0; i < data.length; i++) {
                        $('#tabla_det_prospectos').find('tbody').append('<tr style="text-align:center"><td>'
                            + data[i].cliente + '</td><td>'
                            + data[i].razon_social + '</td><td>'
                            + data[i].documento + '</td><td>'
                            + data[i].telefono + '</td><td>'
                            + data[i].celular + '</td><td>'
                            + data[i].correo + '</td><td>'
                            + data[i].direccion + '</td><td>'
                            + data[i].fecha + '</td><td>'
                            + data[i].asesor + '</td><td>'
                            + data[i].tramite + '</td><td>'
                            + data[i].origen + '</td></tr>');
                    }
                },
                complete: function (data) {
                    $('#tabla_det_prospectos').dataTable({
                        //"ajax": 'api/datatables.json',
                        dom: "<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'copy', className: 'btn-sm' },
                            { extend: 'csv', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'pdf', title: 'ExampleFile', className: 'btn-sm' },
                            { extend: 'print', className: 'btn-sm' }
                        ]
                    });
                    //$('#modal_prospectos').modal('hide')
                    $('#modal_det_prospectos').modal('show')
                }
            });
        }

        function limpiarGrafica() { }

        function listar_asesor() {
            $.ajax({
                url: '/indicadoresCoordinadorC/listarAsesor',
                data: {
                },
                type: "post",
                cache: false,
                success: function (data) {
                    console.log(data)
                    $('#listar_asesor').empty();

                    for (var i = 0; i < data.length; i++) {
                        $('#listar_asesor').append($('<option>', {

                            value: data[i].user_id,
                            text: data[i].nombre
                        }));
                    }

                    $('#listar_asesor').multiselect("destroy").multiselect({
                        includeSelectAllOption: true,
                        maxHeight: 800,
                    });
                    $('#listar_asesor').multiselect('refresh');
                }
            });
        } //ok


    </script>
}