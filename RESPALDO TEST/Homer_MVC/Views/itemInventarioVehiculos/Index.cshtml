@{
    ViewBag.Icono = "fa fa-cubes";
    ViewBag.Title = "Consulta Item Inventario";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Styles {
    <link href="~/Vendor/BootstrapMultiselect/multiselect.css" rel="stylesheet" />
    <link href="~/Vendor/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="~/Vendor/bootstrap-toggle-master/css/bootstrap-toggle.min.css" rel="stylesheet" />
    <link href="~/Vendor/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />
    @Styles.Render("~/bundles/select2/css")
}

<div class="panel-body">
    <div class="panel-heading" style="background-color:white;  border:solid 1px; border-color:#e4e5e7">
        <div class="panel-body">

            <div id="hbreadcrumb" class="pull-right">

                <button type="button" class="btn btn-mini btn-default" style="border-radius:25px" data-container="body" data-toggle="popover" data-placement="left" data-title="Enlaces" data-content="<ul>@ViewBag.nombreEnlaces</ul>" data-html="true">
                    <i class="text-info fa fa-tags"></i>
                </button>
                <button type="button" class="btn btn-mini btn-default" style="border-radius:25px" data-container="body" data-toggle="popover" data-placement="left" data-title="Documentos" data-content="<ul></i><a href=''>Documento 1</a></ul>  <ul></i><a href=''>Documento 2</a></ul> <ul></i><a href=''>Documento 3</a></ul>" data-html="true">
                    <i class="text-primary fa fa-files-o"></i>
                </button>
                <button type="button" class="btn btn-mini btn-default" style="border-radius:25px" data-container="body" data-toggle="popover" data-placement="left" data-title="Favoritos" data-content="@ViewBag.Favoritos" data-html="true">
                    <i class="text-warning fa fa-star"></i>
                </button>

            </div>
            <h3 class="font-light m-b-xs">
                <i class="text-info @ViewBag.Icono"></i>&nbsp;&nbsp;@ViewBag.Title
            </h3>
            <small>Registro @ViewBag.Title</small>
        </div>
    </div>
</div>

<div class="panel-body" style="padding-top:0px;">
    <div class="hpanel">
        @if (TempData["mensaje"] != null)
        {
            <div class="alert alert-success  alert-dismissible" id="mensaje">
                <button type="button" class="close" data-dismiss="alert" arial-label="close"><span aria-hidden="true">&times;</span></button>
                <p>@TempData["mensaje"]</p>
            </div>
        }

        @if (TempData["mensaje_error"] != null)
        {
            <div class="alert alert-danger  alert-dismissible" id="mensaje_error">
                <button type="button" class="close" data-dismiss="alert" arial-label="close"><span aria-hidden="true">&times;</span></button>
                <p>@TempData["mensaje_error"]</p>
            </div>
        }

        <div id="tabs" class="tab-content">

            <div class="m float-e-margins text-right">
                <div class="tooltip-demo">

                    <div id="div-mensaje"></div>

                </div>
            </div>

            <ul id="tabs-crear" class="nav nav-tabs">
                <li class="active"><a data-toggle="tab" href="#crear"><i class="@ViewBag.Icono"></i>&nbsp;&nbsp;@ViewBag.Title</a></li>
                <li class="tabOculto" style="display:none"><a data-toggle="tab" href="#stock"><i class="fa fa-cog"></i>&nbsp;&nbsp;Stock</a></li>
                <li class="tabOculto" style="display:none"><a data-toggle="tab" href="#precios"><i class="fa fa-usd"></i>&nbsp;&nbsp;Precio</a></li>
                <li class="tabOculto" style="display:none"><a data-toggle="tab" href="#historial"><i class="fa fa-clone"></i>&nbsp;&nbsp;Historial</a></li>
                <li class="tabOculto" style="display:none"><a data-toggle="tab" href="#pedidos"><i class="fa fa-book"></i>&nbsp;&nbsp;Pedidos</a></li>
                <li class="tabOculto" style="display:none"><a data-toggle="tab" href="#Trazabilidad"><i class="fa fa-file-excel-o"></i>&nbsp;&nbsp;Trazabilidad </a></li>
            </ul>

            <div id="crear" class="tab-pane active">
                <div class="panel-body">

                    @Html.AntiForgeryToken()
                    @Html.Hidden("menu")

                    <div class="form-horizontal">

                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                        <div class="hpanel">
                            <div class="panel-heading hbuilt" style="background-color:#e4e5e7">
                                <div class="panel-tools">
                                    <a class="showhide"><i class="fa fa-chevron-up"></i></a>

                                </div>
                                <i class="@ViewBag.Icono"></i>&nbsp;&nbsp;&nbsp;Datos generales
                            </div>
                            <div class="panel-body">

                                <form id="Referenceform" onsubmit="return false" method="post" name="myForm">

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Modelo:&nbsp;<span class="text-danger">*</span></label>
                                            <div class="col-md-6">
                                                @Html.DropDownList("referencia", null, "", htmlAttributes: new { @class = "form-control js-source-states", @placeholder = "Seleccione", @required = "required" })
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Bodega(s):&nbsp;<span class="text-danger">*</span></label>
                                            <div class="col-md-6">
                                                <select id="bodccs_cod" name="bodccs_cod" multiple="multiple" required>
                                                    @foreach (var item in ViewBag.bodccs_cod)
                                                    {
                                                        <option value="@item.id">@item.bodccs_nombre</option>
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    @*<div class="col-sm-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">Fecha Inicial:&nbsp;<span class="text-danger">*</span></label>
                                                <div class="col-md-6">
                                                    @Html.Editor("fechaInicial", new { htmlAttributes = new { @class = "form-control campoFecha", @required = "required", @placeholder = "Digite fecha" } })
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">Fecha Final:&nbsp;<span class="text-danger">*</span></label>
                                                <div class="col-md-6">
                                                    @Html.Editor("fechaFinal", new { htmlAttributes = new { @class = "form-control campoFecha", @required = "required", @placeholder = "Digite fecha" } })
                                                </div>
                                            </div>
                                        </div>*@

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <div class="col-md-6 col-md-offset-4">
                                                <button type="submit" class="btn btn-primary" id="btnBuscarReferencia"><i class="fa fa-search"></i>&nbsp;&nbsp;Buscar</button>
                                            </div>
                                        </div>
                                    </div>

                                </form>

                            </div>
                        </div>
                        
                        <div class="hpanel panelBusquedaReferencia" style="display:none;">
                            <div class="panel-heading hbuilt" style="background-color:#e4e5e7">
                                <div class="panel-tools">
                                    <a class="showhide"><i class="fa fa-chevron-up"></i></a>
                                </div>
                                <i class="fa fa-car"></i>&nbsp;&nbsp;&nbsp;Datos Vehiculo
                            </div>
                            <div class="panel-body">

                                <div class="col-lg-3 text-center areaRepuesto" style="display:none;">
                                    <i class="fa fa-cogs big-icon text-muted"></i>
                                    <p class="small m-t-md">Datos referencia</p><br />
                                </div>

                                <div class="col-lg-3 text-center areaVehiculo">
                                    <i class="fa fa-car big-icon text-muted"></i>
                                    <p class="small m-t-md">Datos del vehículo</p><br />
                                </div>

                                <div class="col-lg-9">

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Codigo:</label>
                                            <div class="col-md-6">
                                                <p id="lbCodigo"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Descripcion:</label>
                                            <div class="col-md-6">
                                                <p id="lbDescripcion"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Porcentaje Iva:</label>
                                            <div class="col-md-6">
                                                <p id="lbPorcentajeIva"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Proveedor:</label>
                                            <div class="col-md-6">
                                                <p id="lbProveedor"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6 areaRepuesto">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Porcentaje Iva Compra:</label>
                                            <div class="col-md-6">
                                                <p id="lbPorcentajeIvaCompra"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6 areaRepuesto">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Unidad Medida:</label>
                                            <div class="col-md-6">
                                                <p id="lbUnidadMedida"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6 areaRepuesto">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Clasificacion:</label>
                                            <div class="col-md-6">
                                                <p id="lbClasificacion"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-6 areaVehiculo">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">Serie:</label>
                                                <div class="col-md-6">
                                                    <p id="lbSerie"></p>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-6 areaVehiculo">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">Placa:</label>
                                                <div class="col-md-6">
                                                    <p id="lbPlaca"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-6 areaVehiculo">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">Motor:</label>
                                                <div class="col-md-6">
                                                    <p id="lbMotor"></p>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-6 areaVehiculo">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">Marca:</label>
                                                <div class="col-md-6">
                                                    <p id="lbMarca"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6 areaVehiculo">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Color:</label>
                                            <div class="col-md-6">
                                                <p id="lbColor"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6 areaVehiculo">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Año:</label>
                                            <div class="col-md-6">
                                                <p id="lbAnio"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6 areaVehiculo">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Tipo Servicio:</label>
                                            <div class="col-md-6">
                                                <p id="lbTipoServicio"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-6 areaVehiculo">
                                        <div class="form-group">
                                            <label class="control-label col-md-4">Porcentaje Impuesto Consumo:</label>
                                            <div class="col-md-6">
                                                <p id="lbPorcentajeImpConsumo"></p>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>

                    </div>

                </div>
            </div>

            <div id="stock" class="tab-pane">
                <div class="panel-body">

                    <div class="hpanel">
                        <div class="panel-heading hbuilt" style="background-color:#e4e5e7">
                            <div class="panel-tools">
                                <a class="showhide"><i class="fa fa-chevron-up"></i></a>

                            </div>
                            <i class="fa fa-cog"></i>&nbsp;&nbsp;&nbsp;Datos stock
                        </div>
                        <div class="panel-body">

                            <div class="panel-body-busqueda">
                                <div class="table-responsive">
                                    <div id="div-mensaje-buscar"></div>
                                    <table class="table table-striped table-bordered table-hover" id="tablaStock">
                                        <thead>
                                            <tr>
                                                <th style="text-align:center">Bodega</th>
                                                <th style="text-align:center">Descripcion</th>
                                                <th style="text-align:center">Cantidad</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>

                            </div>

                        </div>
                    </div>

                </div>
            </div>

            <div id="precios" class="tab-pane">
                <div class="panel-body">

                    <div class="hpanel">
                        <div class="panel-heading hbuilt" style="background-color:#e4e5e7">
                            <div class="panel-tools">
                                <a class="showhide"><i class="fa fa-chevron-up"></i></a>

                            </div>
                            <i class="fa fa-usd"></i>&nbsp;&nbsp;&nbsp;Datos precios
                        </div>
                        <div class="panel-body">

                            <div class="panel-body-busqueda">
                                <div class="table-responsive">
                                    <div id="div-mensaje-buscar"></div>
                                    <table class="table table-striped table-bordered table-hover" id="tablaPrecios">
                                        <thead>
                                            <tr>
                                                <th style="text-align:center">Bodega</th>
                                                <th style="text-align:center">Descripcion</th>
                                                <th style="text-align:center">Cantidad</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>

                            </div>

                        </div>
                    </div>

                </div>
            </div>

            <div id="historial" class="tab-pane">
                <div class="panel-body">

                    <div class="hpanel">
                        <div class="panel-heading hbuilt" style="background-color:#e4e5e7">
                            <div class="panel-tools">
                                <a class="showhide"><i class="fa fa-chevron-up"></i></a>

                            </div>
                            <i class="fa fa-usd"></i>&nbsp;&nbsp;&nbsp;Datos historial
                        </div>
                        <div class="panel-body">

                            <div class="row">
                                <div class="col-sm-6 col-md-offset-3">
                                    <div class="form-group">
                                        <div class="col-md-7">
                                            <div class="input-group m-b">
                                                @Html.Editor("fechaInicial", new { htmlAttributes = new { @class = "form-control campoFecha", @placeholder = "Fecha Desde" } })
                                                <span class="input-group-addon">-</span>
                                                @Html.Editor("fechaFinal", new { htmlAttributes = new { @class = "form-control campoFecha", @placeholder = "Fecha Hasta" } })
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <button type="button" class="btn btn-primary" id="btnBuscarHistorial"><i class="fa fa-search">&nbsp;&nbsp;Buscar</i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="panel-body-busqueda">
                                <div class="table-responsive">
                                    <div id="div-mensaje-buscar"></div>
                                    <table class="table table-striped table-bordered table-hover" id="tablaHistorial">
                                        <thead>
                                            <tr>
                                                <th style="text-align:center">Tipo Documento</th>
                                                <th style="text-align:center">Numero</th>
                                                <th style="text-align:center">Tercero</th>
                                                <th style="text-align:center">Bodega</th>
                                                <th style="text-align:center">Fecha</th>
                                                <th style="text-align:center">Cantidad</th>
                                                <th style="text-align:center">Costo Unitario</th>
                                                <th style="text-align:center">Costo Total</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>

                            </div>

                        </div>
                    </div>

                </div>
            </div>

            <div id="pedidos" class="tab-pane">
                <div class="panel-body">

                    <div class="hpanel">
                        <div class="panel-heading hbuilt" style="background-color:#e4e5e7">
                            <div class="panel-tools">
                                <a class="showhide"><i class="fa fa-chevron-up"></i></a>

                            </div>
                            <i class="fa fa-book"></i>&nbsp;&nbsp;&nbsp;Datos Pedidos
                        </div>
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-6 col-md-offset-3">
                                    <div class="form-group">
                                        <div class="col-md-7">
                                            <div class="input-group m-b">
                                                @Html.Editor("fechaInicialPedidos", new { htmlAttributes = new { @class = "form-control campoFecha", @placeholder = "Fecha Desde" } })
                                                <span class="input-group-addon">-</span>
                                                @Html.Editor("fechaFinalPedidos", new { htmlAttributes = new { @class = "form-control campoFecha", @placeholder = "Fecha Hasta" } })
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <button type="button" class="btn btn-primary" id="btnBuscarPedidos"><i class="fa fa-search">&nbsp;&nbsp;Buscar</i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="panel-body-busqueda">
                                <div class="table-responsive">
                                    <div id="div-mensaje-buscar"></div>
                                    <table class="table table-striped table-bordered table-hover" id="tablaPedidos">
                                        <thead>
                                            <tr>
                                                <th style="text-align:center">Número</th>
                                                <th style="text-align:center">Fecha Pedido</th>
                                                <th style="text-align:center">Cotización</th>
                                                <th style="text-align:center">Bodega</th>
                                                <th style="text-align:center">Documento</th>
                                                <th style="text-align:center">Nombre</th>
                                                <th style="text-align:center">Vendedor</th>
                                                <th style="text-align:center">Modelo</th>
                                                <th style="text-align:center">Descripción</th>
                                                <th style="text-align:center">Año</th>
                                                <th style="text-align:center">Color</th>
                                                <th style="text-align:center">Fecha Plan Mayor</th>
                                                <th style="text-align:center">Valor Unitario</th>
                                                <th style="text-align:center">IVA</th>
                                                <th style="text-align:center">Impocomsumo</th>
                                                <th style="text-align:center">Valor Total</th>
                                                <th style="text-align:center">Valor Póliza</th>
                                                <th style="text-align:center">Nit Prenda</th>
                                                <th style="text-align:center">Número de Factura</th>
                                                <th style="text-align:center">Código Flota</th>
                                                <th style="text-align:center">Descripción Flota</th>
                                                <th style="text-align:center">Valor Matrícula</th>
                                                <th style="text-align:center">Valor SOAT</th>

                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>

                        </div>
                    </div>

                </div>
            </div>

            <div id="Trazabilidad" class="tab-pane">
                <div class="panel-body">
                    <div class="hpanel">
                        <div class="panel-heading hbuilt" style="background-color:#e4e5e7">
                            <div class="panel-tools">
                                <a class="showhide"><i class="fa fa-chevron-up"></i></a>
                            </div>
                            <i class="fa fa-file-excel-o"></i>&nbsp;&nbsp;&nbsp;Datos Trazabilidad
                        </div>
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-6 col-md-offset-3">
                                    <div class="form-group">
                                        <div class="col-md-7">
                                            <div class="input-group m-b">
                                                @Html.Editor("fechaInicialTrazabilidad", new { htmlAttributes = new { @class = "form-control campoFecha", @placeholder = "Fecha Desde" } })
                                                <span class="input-group-addon">-</span>
                                                @Html.Editor("fechaFinalTrazabilidad", new { htmlAttributes = new { @class = "form-control campoFecha", @placeholder = "Fecha Hasta" } })
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <button type="button" class="btn btn-primary" id="btnBuscarTrazabilidad"><i class="fa fa-search">&nbsp;&nbsp;Buscar</i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="panel-body-busqueda">
                                <div class="table-responsive">
                                    <div id="div-mensaje-buscar"></div>
                                    <table class="table table-striped table-bordered table-hover" id="tablaTrazabilidad">
                                        <thead>
                                            <tr>
                                                <th style="text-align:center">#</th>
                                                <th style="text-align:center">Descripción</th>
                                                <th style="text-align:center">Fecha Evento</th>
                                                <th style="text-align:center">Bodega</th>
                                                <th style="text-align:center">Ubicación</th>
                                                <th style="text-align:center">Placa</th>
                                                <th style="text-align:center">Observación</th>
                                                <th style="text-align:center">Tramitador</th>
                                                <th style="text-align:center">Técnico</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/select2/js")
    <script src="~/Vendor/BootstrapMultiselect/multiselect.js"></script>
    <script src="~/Vendor/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="~/Vendor/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/Vendor/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
    <script src="~/Vendor/datatablesExcelExport/dataTable1.4.0-buttons.js"></script>
    <script src="~/Vendor/datatablesExcelExport/JSZip3.1.3.min.js"></script>
    <script src="~/Vendor/pdfmake/build/pdfmake.min.js"></script>
    <script src="~/Vendor/pdfmake/build/vfs_fonts.js"></script>
    <script src="~/Vendor/datatablesExcelExport/jsZipDataTables.js"></script>
    <script src="~/Vendor/bootstrap-toggle-master/js/bootstrap-toggle.min.js"></script>
    <script src="~/Vendor/moment/min/moment.min.js"></script>
    <script src="~/Vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    <script type="text/javascript">

        $(document).ready(function () {
            $('#referencia').select2();
            $('.campoFecha').datetimepicker({
                format: 'DD/MM/YYYY'
            });
            $('#bodccs_cod').multiselect({
                includeSelectAllOption: true,
                maxHeight: 400,
                enableFiltering: true,
                enableCaseInsensitiveFiltering: true
            });
        });

        $('#Referenceform').submit(function () {
            event.preventDefault();
        });

        // Area para que las fechas no cambien de un panel a otro
        $('#fechaInicialOrdenes').blur(function () {
            $('#fechaInicial').val($('#fechaInicialOrdenes').val());
            $('#fechaInicialPedidos').val($('#fechaInicialOrdenes').val());
        });
        $('#fechaFinalOrdenes').blur(function () {
            $('#fechaFinal').val($('#fechaFinalOrdenes').val());
            $('#fechaFinalPedidos').val($('#fechaFinalOrdenes').val());
        });
        $('#fechaInicial').blur(function () {
            $('#fechaInicialOrdenes').val($('#fechaInicial').val());
            $('#fechaInicialPedidos').val($('#fechaInicial').val());
        });
        $('#fechaFinal').blur(function () {
            $('#fechaFinalOrdenes').val($('#fechaFinal').val());
            $('#fechaFinalPedidos').val($('#fechaFinal').val());
        });
        $('#fechaInicialPedidos').blur(function () {
            $('#fechaInicialOrdenes').val($('#fechaInicialPedidos').val());
            $('#fechaInicial').val($('#fechaInicialPedidos').val());
        });
        $('#fechaFinalPedidos').blur(function () {
            $('#fechaFinalOrdenes').val($('#fechaFinalPedidos').val());
            $('#fechaFinal').val($('#fechaFinalPedidos').val());
        });
        $('#fechaInicialTrazabilidad').blur(function () {
            $('#fechaInicialOrdenes').val($('#fechaInicialTrazabilidad').val());
            $('#fechaInicial').val($('#fechaInicialTrazabilidad').val());
        });
        $('#fechaFinalTrazabilidad').blur(function () {
            $('#fechaFinalOrdenes').val($('#fechaFinalTrazabilidad').val());
            $('#fechaFinal').val($('#fechaFinalTrazabilidad').val());
        });

        $('#btnBuscarPedidos').click(function () {
            buscarPedidos();
            buscarHistorial();
            buscarOrdenesCompra();
        });
        $('#btnBuscarOrdenesCompra').click(function () {
            buscarOrdenesCompra();
            buscarHistorial();
            buscarPedidos();
        });
        $('#btnBuscarHistorial').click(function () {
            buscarHistorial();
            buscarOrdenesCompra();
            buscarPedidos();
        });
        $('#btnBuscarReferencia').click(function () {

            $.ajax({
                url: '/itemInventario/BuscarCodigoReferencia',
                data: {
                    codigo: $('#referencia').val(),
                    bodegas: $('#bodccs_cod').val()
                },
                type: "post",
                cache: false,
                success: function (data) {
                    if (data.tipoReferencia == 'R') {
                        $('#lbCodigo').text(data.buscarReferencia.ref_codigo)
                        $('#lbDescripcion').text(data.buscarReferencia.ref_descripcion)
                        $('#lbPorcentajeIva').text(data.buscarReferencia.por_iva)
                        $('#lbPorcentajeIvaCompra').text(data.buscarReferencia.por_iva_compra)
                        $('#lbUnidadMedida').text(data.buscarReferencia.unidad_medida)
                        $('#lbProveedor').text(data.buscarReferencia.proveedor)
                        $('#lbClasificacion').text(data.buscarReferencia.clasificacion_ABC)
                        $('.areaVehiculo').hide();
                        $('.areaRepuesto').show();
                        $('.panelBusquedaReferencia').show();

                        $('#tablaStock').find('tbody').empty();
                        for (var i = 0; i < data.buscarStock.length; i++) {
                            $('#tablaStock').find('tbody').append('<tr><td align="right">' + data.buscarStock[i].bodccs_cod + '</td><td align="left">' + data.buscarStock[i].bodccs_nombre + '</td><td align="left">'
                                           + data.buscarStock[i].stock + '</td></tr>');
                        }

                    } else {
                        $('#lbCodigo').text(data.buscarReferencia.ref_codigo)
                        $('#lbDescripcion').text(data.buscarReferencia.ref_descripcion)
                        $('#lbProveedor').text(data.buscarReferencia.proveedor)
                        $('#lbSerie').text(data.buscarReferencia.vin)
                        $('#lbPlaca').text(data.buscarReferencia.plac_vh)
                        $('#lbMotor').text(data.buscarReferencia.nummot_vh)
                        $('#lbMarca').text(data.buscarReferencia.marcvh_nombre)
                        $('#lbColor').text(data.buscarReferencia.colvh_nombre)
                        $('#lbAnio').text(data.buscarReferencia.anio_vh)
                        $('#lbPorcentajeImpConsumo').text(data.buscarReferencia.impconsumo)
                        $('#lbTipoServicio').text(data.buscarReferencia.tpserv_nombre)
                        $('.areaRepuesto').hide();
                        $('.areaVehiculo').show();
                        $('.panelBusquedaReferencia').show();

                        $('#tablaStock').find('tbody').empty();
                        for (var i = 0; i < data.buscarStock.length; i++) {
                            $('#tablaStock').find('tbody').append('<tr><td align="right">' + data.buscarStock[i].bodccs_cod + '</td><td align="left">' + data.buscarStock[i].bodccs_nombre + '</td><td align="left">'
                                           + data.buscarStock[i].stock + '</td></tr>');
                        }
                    }
                },
                complete: function () {
                    $('.tabOculto').show();
                }
            })
        });
        $('#btnBuscarTrazabilidad').click(function () {
            buscarPedidos()
            buscarOrdenesCompra()
            buscarHistorial()
            buscarTrazabilidad()
        })

        function buscarPedidos() {
            $('#tablaPedidos').dataTable().fnDestroy();
            $.ajax({
                url: '/itemInventarioVehiculos/BuscarPedidos',
                data: {
                    codigo: $('#referencia').val(),
                    bodegas: $('#bodccs_cod').val(),
                    fechaInicial: $('#fechaInicialPedidos').val(),
                    fechaFinal: $('#fechaFinalPedidos').val()
                },
                type: "post",
                cache: false,
                success: function (data) {
                    console.log(data)
                    $('#tablaPedidos').find('tbody').empty();
                    for (var i = 0; i < data.length; i++) {
                        $('#tablaPedidos').find('tbody').append(
                            '<tr>'
                                + '<td align="left">' + data[i].numero + '</td>'
                                + '<td align="left">' + data[i].fecha + '</td>'
                                + '<td align="left">' + data[i].cot_numcotizacion + '</td>'
                                + '<td align="left">' + data[i].bodccs_nombre + '</td>'
                                + '<td align="left">' + data[i].doc_tercero + '</td>'
                                + '<td align="left">' + data[i].nombre + '</td>'
                                + '<td align="left">' + data[i].vendedor + '</td>'
                                + '<td align="left">' + data[i].modelo + '</td>'
                                + '<td align="left">' + data[i].modvh_nombre + '</td>'
                                + '<td align="left">' + data[i].id_anio_modelo + '</td>'
                                + '<td align="left">' + data[i].color + '</td>'
                                + '<td align="left">' + data[i].fecha_asignacion_planmayor + '</td>'
                                + '<td align="left">' + data[i].valor_unitario + '</td>'
                                + '<td align="left">' + data[i].porcentaje_iva + '</td>'
                                + '<td align="left">' + data[i].porcentaje_impoconsumo + '</td>'
                                + '<td align="left">' + data[i].vrtotal + '</td>'
                                + '<td align="left">' + data[i].valorPoliza + '</td>'
                                + '<td align="left">' + data[i].nit_prenda + '</td>'
                                + '<td align="left">' + data[i].numfactura + '</td>'
                                + '<td align="left">' + data[i].codigoFlota + '</td>'
                                + '<td align="left">' + data[i].descripcionFlota + '</td>'
                                + '<td align="left">' + data[i].valormatricula + '</td>'
                                + '<td align="left">' + data[i].valorsoat + '</td>'
                           + '</tr>');
                    }
                },
                complete: function () {
                    $('#tablaPedidos').dataTable({
                        //"ajax": 'api/datatables.json',
                        //dom: "<''<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'excel', className: 'btn-sm', text: 'Exportar a Excel' },
                            //{ extend: 'pdf', title: 'ExampleFile', className: 'btn-sm', text: 'PDF' },
                            //{ extend: 'print', className: 'btn-sm', text: 'Imprimir' }
                        ]
                    });
                }

            })
        };

        function buscarOrdenesCompra() {
            $('#tablaOrdenes').dataTable().fnDestroy();
            $.ajax({
                url: '/itemInventario/BuscarOrdenesCompra',
                data: {
                    codigo: $('#referencia').val(),
                    bodegas: $('#bodccs_cod').val(),
                    fechaInicial: $('#fechaInicial').val(),
                    fechaFinal: $('#fechaFinal').val()
                },
                type: "post",
                cache: false,
                success: function (data) {

                    $('#tablaOrdenes').find('tbody').empty();
                    for (var i = 0; i < data.length; i++) {
                        $('#tablaOrdenes').find('tbody').append('<tr><td align="left">' + data[i].tpdoc_nombre + '</td><td align="left">' + data[i].numero + '</td><td align="left">'
                                        + data[i].fec_creacion + '</td><td align="left">'
                                        + data[i].bodccs_nombre + '</td><td align="left">'
                                        + data[i].descripcion + '</td><td align="left">'
                                        + data[i].proveedor + '</td><td align="left">'
                                        + data[i].destinatario + '</td><td align="left">'
                                        + data[i].vendedor + '</td><td align="left">'
                                        + addComas(data[i].valorunitario) + '</td><td align="left">'
                                        + data[i].cantidad + '</td><td align="left">'
                                        + data[i].porcendescto + '</td><td align="left">'
                                        + data[i].porceniva + '</td><td align="left">'
                                        + addComas(data[i].total) + '</td></tr>');
                    }
                    $('#tablaOrdenes').dataTable({
                        //"ajax": 'api/datatables.json',
                        //dom: "<''<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'excel', className: 'btn-sm', text: 'Exportar a Excel' },
                            //{ extend: 'pdf', title: 'ExampleFile', className: 'btn-sm', text: 'PDF' },
                            //{ extend: 'print', className: 'btn-sm', text: 'Imprimir' }
                        ]
                    });
                }
            })
        };

        function buscarHistorial() {
            $('#tablaHistorial').dataTable().fnDestroy();
            $.ajax({
                url: '/itemInventario/BuscarHistorial',
                data: {
                    codigo: $('#referencia').val(),
                    bodegas: $('#bodccs_cod').val(),
                    fechaInicial: $('#fechaInicial').val(),
                    fechaFinal: $('#fechaFinal').val()
                },
                type: "post",
                cache: false,
                success: function (data) {

                    $('#tablaHistorial').find('tbody').empty();
                    for (var i = 0; i < data.length; i++) {
                        $('#tablaHistorial').find('tbody').append('<tr><td align="left">' + data[i].documento + '</td><td align="left">' + data[i].numero + '</td><td align="left">'
                                        + data[i].tercero + '</td><td align="left">'
                                        + data[i].bodccs_nombre + '</td><td align="left">' + data[i].fec + '</td><td align="left">'
                                        + data[i].cantidad + '</td><td align="left">' + addComas(data[i].costo_unitario) + '</td><td align="left">'
                                        + addComas(data[i].costoTotal) + '</td></tr>');
                    }
                    $('#tablaHistorial').dataTable({
                        //"ajax": 'api/datatables.json',
                        //dom: "<''<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>t<'col-sm-4'i>p",
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [
                            { extend: 'excel', className: 'btn-sm', text: 'Exportar a Excel' },
                            //{ extend: 'pdf', title: 'ExampleFile', className: 'btn-sm', text: 'PDF' },
                            //{ extend: 'print', className: 'btn-sm', text: 'Imprimir' }
                        ]
                    });
                }
            })
        };

        function buscarTrazabilidad() {
            $('#tablaTrazabilidad').dataTable().fnDestroy();
            $.ajax({
                url: '/itemInventarioVehiculos/buscarTrazabilidad',
                data: {
                    codigo: $('#referencia').val(),
                    bodegas: $('#bodccs_cod').val(),
                    fechaInicial: $('#fechaInicial').val(),
                    fechaFinal: $('#fechaFinal').val()
                },
                type: "post",
                cache: false,
                success: function (data) {
                    var contador = 1;
                    $('#tablaTrazabilidad').find('tbody').empty();
                    for (var i = 0; i < data.length; i++) {
                        $('#tablaTrazabilidad').find('tbody').append(
                                '<tr>'
                                    + '<td align="right"><strong>' + contador + '</strong></td>'
                                    + '<td>' + data[i].descripcion + '</td>'
                                    + '<td align="right">' + data[i].fechaEvento + '</td>'
                                    + '<td>' + data[i].bodega + '</td>'
                                    + '<td>' + data[i].ubicacion + '</td>'
                                    + '<td>' + data[i].placa + '</td>'
                                    + '<td>' + data[i].observacion + '</td>'
                                    + '<td>' + data[i].tramitador + '</td>'
                                    + '<td>' + data[i].tecnico + '</td>'
                              + '</tr>'
                            )
                        contador++
                    }
                },
                complete: function (data) {
                    $('#tablaTrazabilidad').dataTable({
                        dom: "<''<'col-md-6'l><'col-md-6'f>>t<'col-md-4'i><'col-md-8 text-right'pB>",
                        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                        buttons: [ ]
                    });
                }
            })
        }

    </script>

}